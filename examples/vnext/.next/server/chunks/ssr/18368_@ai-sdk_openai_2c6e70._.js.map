{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/openai-provider.ts","file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/openai-chat-language-model.ts","file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/convert-to-openai-chat-messages.ts","file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/map-openai-chat-logprobs.ts","file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/map-openai-finish-reason.ts","file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/openai-error.ts","file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/get-response-metadata.ts","file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/openai-prepare-tools.ts","file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/openai-completion-language-model.ts","file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/convert-to-openai-completion-prompt.ts","file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/map-openai-completion-logprobs.ts","file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/openai-embedding-model.ts"],"sourcesContent":["import {\n  EmbeddingModelV1,\n  LanguageModelV1,\n  ProviderV1,\n} from '@ai-sdk/provider';\nimport {\n  FetchFunction,\n  loadApiKey,\n  withoutTrailingSlash,\n} from '@ai-sdk/provider-utils';\nimport { OpenAIChatLanguageModel } from './openai-chat-language-model';\nimport { OpenAIChatModelId, OpenAIChatSettings } from './openai-chat-settings';\nimport { OpenAICompletionLanguageModel } from './openai-completion-language-model';\nimport {\n  OpenAICompletionModelId,\n  OpenAICompletionSettings,\n} from './openai-completion-settings';\nimport { OpenAIEmbeddingModel } from './openai-embedding-model';\nimport {\n  OpenAIEmbeddingModelId,\n  OpenAIEmbeddingSettings,\n} from './openai-embedding-settings';\n\nexport interface OpenAIProvider extends ProviderV1 {\n  (\n    modelId: 'gpt-3.5-turbo-instruct',\n    settings?: OpenAICompletionSettings,\n  ): OpenAICompletionLanguageModel;\n  (modelId: OpenAIChatModelId, settings?: OpenAIChatSettings): LanguageModelV1;\n\n  /**\nCreates an OpenAI model for text generation.\n   */\n  languageModel(\n    modelId: 'gpt-3.5-turbo-instruct',\n    settings?: OpenAICompletionSettings,\n  ): OpenAICompletionLanguageModel;\n  languageModel(\n    modelId: OpenAIChatModelId,\n    settings?: OpenAIChatSettings,\n  ): LanguageModelV1;\n\n  /**\nCreates an OpenAI chat model for text generation.\n   */\n  chat(\n    modelId: OpenAIChatModelId,\n    settings?: OpenAIChatSettings,\n  ): LanguageModelV1;\n\n  /**\nCreates an OpenAI completion model for text generation.\n   */\n  completion(\n    modelId: OpenAICompletionModelId,\n    settings?: OpenAICompletionSettings,\n  ): LanguageModelV1;\n\n  /**\nCreates a model for text embeddings.\n   */\n  embedding(\n    modelId: OpenAIEmbeddingModelId,\n    settings?: OpenAIEmbeddingSettings,\n  ): EmbeddingModelV1<string>;\n\n  /**\nCreates a model for text embeddings.\n\n@deprecated Use `textEmbeddingModel` instead.\n   */\n  textEmbedding(\n    modelId: OpenAIEmbeddingModelId,\n    settings?: OpenAIEmbeddingSettings,\n  ): EmbeddingModelV1<string>;\n\n  /**\nCreates a model for text embeddings.\n   */\n  textEmbeddingModel(\n    modelId: OpenAIEmbeddingModelId,\n    settings?: OpenAIEmbeddingSettings,\n  ): EmbeddingModelV1<string>;\n}\n\nexport interface OpenAIProviderSettings {\n  /**\nBase URL for the OpenAI API calls.\n     */\n  baseURL?: string;\n\n  /**\nAPI key for authenticating requests.\n     */\n  apiKey?: string;\n\n  /**\nOpenAI Organization.\n     */\n  organization?: string;\n\n  /**\nOpenAI project.\n     */\n  project?: string;\n\n  /**\nCustom headers to include in the requests.\n     */\n  headers?: Record<string, string>;\n\n  /**\nOpenAI compatibility mode. Should be set to `strict` when using the OpenAI API,\nand `compatible` when using 3rd party providers. In `compatible` mode, newer\ninformation such as streamOptions are not being sent. Defaults to 'compatible'.\n   */\n  compatibility?: 'strict' | 'compatible';\n\n  /**\nProvider name. Overrides the `openai` default name for 3rd party providers.\n   */\n  name?: string;\n\n  /**\nCustom fetch implementation. You can use it as a middleware to intercept requests,\nor to provide a custom fetch implementation for e.g. testing.\n    */\n  fetch?: FetchFunction;\n}\n\n/**\nCreate an OpenAI provider instance.\n */\nexport function createOpenAI(\n  options: OpenAIProviderSettings = {},\n): OpenAIProvider {\n  const baseURL =\n    withoutTrailingSlash(options.baseURL) ?? 'https://api.openai.com/v1';\n\n  // we default to compatible, because strict breaks providers like Groq:\n  const compatibility = options.compatibility ?? 'compatible';\n\n  const providerName = options.name ?? 'openai';\n\n  const getHeaders = () => ({\n    Authorization: `Bearer ${loadApiKey({\n      apiKey: options.apiKey,\n      environmentVariableName: 'OPENAI_API_KEY',\n      description: 'OpenAI',\n    })}`,\n    'OpenAI-Organization': options.organization,\n    'OpenAI-Project': options.project,\n    ...options.headers,\n  });\n\n  const createChatModel = (\n    modelId: OpenAIChatModelId,\n    settings: OpenAIChatSettings = {},\n  ) =>\n    new OpenAIChatLanguageModel(modelId, settings, {\n      provider: `${providerName}.chat`,\n      url: ({ path }) => `${baseURL}${path}`,\n      headers: getHeaders,\n      compatibility,\n      fetch: options.fetch,\n    });\n\n  const createCompletionModel = (\n    modelId: OpenAICompletionModelId,\n    settings: OpenAICompletionSettings = {},\n  ) =>\n    new OpenAICompletionLanguageModel(modelId, settings, {\n      provider: `${providerName}.completion`,\n      url: ({ path }) => `${baseURL}${path}`,\n      headers: getHeaders,\n      compatibility,\n      fetch: options.fetch,\n    });\n\n  const createEmbeddingModel = (\n    modelId: OpenAIEmbeddingModelId,\n    settings: OpenAIEmbeddingSettings = {},\n  ) =>\n    new OpenAIEmbeddingModel(modelId, settings, {\n      provider: `${providerName}.embedding`,\n      url: ({ path }) => `${baseURL}${path}`,\n      headers: getHeaders,\n      fetch: options.fetch,\n    });\n\n  const createLanguageModel = (\n    modelId: OpenAIChatModelId | OpenAICompletionModelId,\n    settings?: OpenAIChatSettings | OpenAICompletionSettings,\n  ) => {\n    if (new.target) {\n      throw new Error(\n        'The OpenAI model function cannot be called with the new keyword.',\n      );\n    }\n\n    if (modelId === 'gpt-3.5-turbo-instruct') {\n      return createCompletionModel(\n        modelId,\n        settings as OpenAICompletionSettings,\n      );\n    }\n\n    return createChatModel(modelId, settings as OpenAIChatSettings);\n  };\n\n  const provider = function (\n    modelId: OpenAIChatModelId | OpenAICompletionModelId,\n    settings?: OpenAIChatSettings | OpenAICompletionSettings,\n  ) {\n    return createLanguageModel(modelId, settings);\n  };\n\n  provider.languageModel = createLanguageModel;\n  provider.chat = createChatModel;\n  provider.completion = createCompletionModel;\n  provider.embedding = createEmbeddingModel;\n  provider.textEmbedding = createEmbeddingModel;\n  provider.textEmbeddingModel = createEmbeddingModel;\n\n  return provider as OpenAIProvider;\n}\n\n/**\nDefault OpenAI provider instance. It uses 'strict' compatibility mode.\n */\nexport const openai = createOpenAI({\n  compatibility: 'strict', // strict for OpenAI API\n});\n","import {\n  InvalidResponseDataError,\n  LanguageModelV1,\n  LanguageModelV1CallWarning,\n  LanguageModelV1FinishReason,\n  LanguageModelV1LogProbs,\n  LanguageModelV1ProviderMetadata,\n  LanguageModelV1StreamPart,\n  UnsupportedFunctionalityError,\n} from '@ai-sdk/provider';\nimport {\n  FetchFunction,\n  ParseResult,\n  combineHeaders,\n  createEventSourceResponseHandler,\n  createJsonResponseHandler,\n  generateId,\n  isParsableJson,\n  postJsonToApi,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod';\nimport { convertToOpenAIChatMessages } from './convert-to-openai-chat-messages';\nimport { mapOpenAIChatLogProbsOutput } from './map-openai-chat-logprobs';\nimport { mapOpenAIFinishReason } from './map-openai-finish-reason';\nimport { OpenAIChatModelId, OpenAIChatSettings } from './openai-chat-settings';\nimport {\n  openaiErrorDataSchema,\n  openaiFailedResponseHandler,\n} from './openai-error';\nimport { getResponseMetadata } from './get-response-metadata';\nimport { prepareTools } from './openai-prepare-tools';\n\ntype OpenAIChatConfig = {\n  provider: string;\n  compatibility: 'strict' | 'compatible';\n  headers: () => Record<string, string | undefined>;\n  url: (options: { modelId: string; path: string }) => string;\n  fetch?: FetchFunction;\n};\n\nexport class OpenAIChatLanguageModel implements LanguageModelV1 {\n  readonly specificationVersion = 'v1';\n\n  readonly modelId: OpenAIChatModelId;\n  readonly settings: OpenAIChatSettings;\n\n  private readonly config: OpenAIChatConfig;\n\n  constructor(\n    modelId: OpenAIChatModelId,\n    settings: OpenAIChatSettings,\n    config: OpenAIChatConfig,\n  ) {\n    this.modelId = modelId;\n    this.settings = settings;\n    this.config = config;\n  }\n\n  get supportsStructuredOutputs(): boolean {\n    return this.settings.structuredOutputs ?? false;\n  }\n\n  get defaultObjectGenerationMode() {\n    // audio models don't support structured outputs:\n    if (isAudioModel(this.modelId)) {\n      return 'tool';\n    }\n\n    return this.supportsStructuredOutputs ? 'json' : 'tool';\n  }\n\n  get provider(): string {\n    return this.config.provider;\n  }\n\n  get supportsImageUrls(): boolean {\n    // image urls can be sent if downloadImages is disabled (default):\n    return !this.settings.downloadImages;\n  }\n\n  private getArgs({\n    mode,\n    prompt,\n    maxTokens,\n    temperature,\n    topP,\n    topK,\n    frequencyPenalty,\n    presencePenalty,\n    stopSequences,\n    responseFormat,\n    seed,\n    providerMetadata,\n  }: Parameters<LanguageModelV1['doGenerate']>[0]) {\n    const type = mode.type;\n\n    const warnings: LanguageModelV1CallWarning[] = [];\n\n    if (topK != null) {\n      warnings.push({\n        type: 'unsupported-setting',\n        setting: 'topK',\n      });\n    }\n\n    if (\n      responseFormat?.type === 'json' &&\n      responseFormat.schema != null &&\n      !this.supportsStructuredOutputs\n    ) {\n      warnings.push({\n        type: 'unsupported-setting',\n        setting: 'responseFormat',\n        details:\n          'JSON response format schema is only supported with structuredOutputs',\n      });\n    }\n\n    const useLegacyFunctionCalling = this.settings.useLegacyFunctionCalling;\n\n    if (useLegacyFunctionCalling && this.settings.parallelToolCalls === true) {\n      throw new UnsupportedFunctionalityError({\n        functionality: 'useLegacyFunctionCalling with parallelToolCalls',\n      });\n    }\n\n    if (useLegacyFunctionCalling && this.supportsStructuredOutputs) {\n      throw new UnsupportedFunctionalityError({\n        functionality: 'structuredOutputs with useLegacyFunctionCalling',\n      });\n    }\n\n    const baseArgs = {\n      // model id:\n      model: this.modelId,\n\n      // model specific settings:\n      logit_bias: this.settings.logitBias,\n      logprobs:\n        this.settings.logprobs === true ||\n        typeof this.settings.logprobs === 'number'\n          ? true\n          : undefined,\n      top_logprobs:\n        typeof this.settings.logprobs === 'number'\n          ? this.settings.logprobs\n          : typeof this.settings.logprobs === 'boolean'\n          ? this.settings.logprobs\n            ? 0\n            : undefined\n          : undefined,\n      user: this.settings.user,\n      parallel_tool_calls: this.settings.parallelToolCalls,\n\n      // standardized settings:\n      max_tokens: maxTokens,\n      temperature,\n      top_p: topP,\n      frequency_penalty: frequencyPenalty,\n      presence_penalty: presencePenalty,\n      response_format:\n        responseFormat?.type === 'json'\n          ? this.supportsStructuredOutputs && responseFormat.schema != null\n            ? {\n                type: 'json_schema',\n                json_schema: {\n                  schema: responseFormat.schema,\n                  strict: true,\n                  name: responseFormat.name ?? 'response',\n                  description: responseFormat.description,\n                },\n              }\n            : { type: 'json_object' }\n          : undefined,\n      stop: stopSequences,\n      seed,\n\n      // openai specific settings:\n      max_completion_tokens:\n        providerMetadata?.openai?.maxCompletionTokens ?? undefined,\n      store: providerMetadata?.openai?.store ?? undefined,\n      metadata: providerMetadata?.openai?.metadata ?? undefined,\n      prediction: providerMetadata?.openai?.prediction ?? undefined,\n\n      // messages:\n      messages: convertToOpenAIChatMessages({\n        prompt,\n        useLegacyFunctionCalling,\n      }),\n    };\n\n    // reasoning models have fixed params, remove them if they are set:\n    if (isReasoningModel(this.modelId)) {\n      baseArgs.temperature = undefined;\n      baseArgs.top_p = undefined;\n      baseArgs.frequency_penalty = undefined;\n      baseArgs.presence_penalty = undefined;\n    }\n\n    switch (type) {\n      case 'regular': {\n        const { tools, tool_choice, functions, function_call, toolWarnings } =\n          prepareTools({\n            mode,\n            useLegacyFunctionCalling,\n            structuredOutputs: this.supportsStructuredOutputs,\n          });\n\n        return {\n          args: {\n            ...baseArgs,\n            tools,\n            tool_choice,\n            functions,\n            function_call,\n          },\n          warnings: [...warnings, ...toolWarnings],\n        };\n      }\n\n      case 'object-json': {\n        return {\n          args: {\n            ...baseArgs,\n            response_format:\n              this.supportsStructuredOutputs && mode.schema != null\n                ? {\n                    type: 'json_schema',\n                    json_schema: {\n                      schema: mode.schema,\n                      strict: true,\n                      name: mode.name ?? 'response',\n                      description: mode.description,\n                    },\n                  }\n                : { type: 'json_object' },\n          },\n          warnings,\n        };\n      }\n\n      case 'object-tool': {\n        return {\n          args: useLegacyFunctionCalling\n            ? {\n                ...baseArgs,\n                function_call: {\n                  name: mode.tool.name,\n                },\n                functions: [\n                  {\n                    name: mode.tool.name,\n                    description: mode.tool.description,\n                    parameters: mode.tool.parameters,\n                  },\n                ],\n              }\n            : {\n                ...baseArgs,\n                tool_choice: {\n                  type: 'function',\n                  function: { name: mode.tool.name },\n                },\n                tools: [\n                  {\n                    type: 'function',\n                    function: {\n                      name: mode.tool.name,\n                      description: mode.tool.description,\n                      parameters: mode.tool.parameters,\n                      strict: this.supportsStructuredOutputs ? true : undefined,\n                    },\n                  },\n                ],\n              },\n          warnings,\n        };\n      }\n\n      default: {\n        const _exhaustiveCheck: never = type;\n        throw new Error(`Unsupported type: ${_exhaustiveCheck}`);\n      }\n    }\n  }\n\n  async doGenerate(\n    options: Parameters<LanguageModelV1['doGenerate']>[0],\n  ): Promise<Awaited<ReturnType<LanguageModelV1['doGenerate']>>> {\n    const { args: body, warnings } = this.getArgs(options);\n\n    const { responseHeaders, value: response } = await postJsonToApi({\n      url: this.config.url({\n        path: '/chat/completions',\n        modelId: this.modelId,\n      }),\n      headers: combineHeaders(this.config.headers(), options.headers),\n      body,\n      failedResponseHandler: openaiFailedResponseHandler,\n      successfulResponseHandler: createJsonResponseHandler(\n        openaiChatResponseSchema,\n      ),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch,\n    });\n\n    const { messages: rawPrompt, ...rawSettings } = body;\n    const choice = response.choices[0];\n\n    let providerMetadata: LanguageModelV1ProviderMetadata | undefined;\n    if (\n      response.usage?.completion_tokens_details?.reasoning_tokens != null ||\n      response.usage?.prompt_tokens_details?.cached_tokens != null\n    ) {\n      providerMetadata = { openai: {} };\n      if (response.usage?.completion_tokens_details?.reasoning_tokens != null) {\n        providerMetadata.openai.reasoningTokens =\n          response.usage?.completion_tokens_details?.reasoning_tokens;\n      }\n      if (response.usage?.prompt_tokens_details?.cached_tokens != null) {\n        providerMetadata.openai.cachedPromptTokens =\n          response.usage?.prompt_tokens_details?.cached_tokens;\n      }\n    }\n\n    return {\n      text: choice.message.content ?? undefined,\n      toolCalls:\n        this.settings.useLegacyFunctionCalling && choice.message.function_call\n          ? [\n              {\n                toolCallType: 'function',\n                toolCallId: generateId(),\n                toolName: choice.message.function_call.name,\n                args: choice.message.function_call.arguments,\n              },\n            ]\n          : choice.message.tool_calls?.map(toolCall => ({\n              toolCallType: 'function',\n              toolCallId: toolCall.id ?? generateId(),\n              toolName: toolCall.function.name,\n              args: toolCall.function.arguments!,\n            })),\n      finishReason: mapOpenAIFinishReason(choice.finish_reason),\n      usage: {\n        promptTokens: response.usage?.prompt_tokens ?? NaN,\n        completionTokens: response.usage?.completion_tokens ?? NaN,\n      },\n      rawCall: { rawPrompt, rawSettings },\n      rawResponse: { headers: responseHeaders },\n      request: { body: JSON.stringify(body) },\n      response: getResponseMetadata(response),\n      warnings,\n      logprobs: mapOpenAIChatLogProbsOutput(choice.logprobs),\n      providerMetadata,\n    };\n  }\n\n  async doStream(\n    options: Parameters<LanguageModelV1['doStream']>[0],\n  ): Promise<Awaited<ReturnType<LanguageModelV1['doStream']>>> {\n    const { args, warnings } = this.getArgs(options);\n\n    const body = {\n      ...args,\n      stream: true,\n\n      // only include stream_options when in strict compatibility mode:\n      stream_options:\n        this.config.compatibility === 'strict'\n          ? { include_usage: true }\n          : undefined,\n    };\n\n    const { responseHeaders, value: response } = await postJsonToApi({\n      url: this.config.url({\n        path: '/chat/completions',\n        modelId: this.modelId,\n      }),\n      headers: combineHeaders(this.config.headers(), options.headers),\n      body,\n      failedResponseHandler: openaiFailedResponseHandler,\n      successfulResponseHandler: createEventSourceResponseHandler(\n        openaiChatChunkSchema,\n      ),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch,\n    });\n\n    const { messages: rawPrompt, ...rawSettings } = args;\n\n    const toolCalls: Array<{\n      id: string;\n      type: 'function';\n      function: {\n        name: string;\n        arguments: string;\n      };\n      hasFinished: boolean;\n    }> = [];\n\n    let finishReason: LanguageModelV1FinishReason = 'unknown';\n    let usage: {\n      promptTokens: number | undefined;\n      completionTokens: number | undefined;\n    } = {\n      promptTokens: undefined,\n      completionTokens: undefined,\n    };\n    let logprobs: LanguageModelV1LogProbs;\n    let isFirstChunk = true;\n\n    const { useLegacyFunctionCalling } = this.settings;\n\n    let providerMetadata: LanguageModelV1ProviderMetadata | undefined;\n    return {\n      stream: response.pipeThrough(\n        new TransformStream<\n          ParseResult<z.infer<typeof openaiChatChunkSchema>>,\n          LanguageModelV1StreamPart\n        >({\n          transform(chunk, controller) {\n            // handle failed chunk parsing / validation:\n            if (!chunk.success) {\n              finishReason = 'error';\n              controller.enqueue({ type: 'error', error: chunk.error });\n              return;\n            }\n\n            const value = chunk.value;\n\n            // handle error chunks:\n            if ('error' in value) {\n              finishReason = 'error';\n              controller.enqueue({ type: 'error', error: value.error });\n              return;\n            }\n\n            if (isFirstChunk) {\n              isFirstChunk = false;\n\n              controller.enqueue({\n                type: 'response-metadata',\n                ...getResponseMetadata(value),\n              });\n            }\n\n            if (value.usage != null) {\n              usage = {\n                promptTokens: value.usage.prompt_tokens ?? undefined,\n                completionTokens: value.usage.completion_tokens ?? undefined,\n              };\n\n              const {\n                completion_tokens_details: completionTokenDetails,\n                prompt_tokens_details: promptTokenDetails,\n              } = value.usage;\n\n              if (\n                completionTokenDetails?.reasoning_tokens != null ||\n                promptTokenDetails?.cached_tokens != null\n              ) {\n                providerMetadata = { openai: {} };\n                if (completionTokenDetails?.reasoning_tokens != null) {\n                  providerMetadata.openai.reasoningTokens =\n                    completionTokenDetails?.reasoning_tokens;\n                }\n                if (promptTokenDetails?.cached_tokens != null) {\n                  providerMetadata.openai.cachedPromptTokens =\n                    promptTokenDetails?.cached_tokens;\n                }\n              }\n            }\n\n            const choice = value.choices[0];\n\n            if (choice?.finish_reason != null) {\n              finishReason = mapOpenAIFinishReason(choice.finish_reason);\n            }\n\n            if (choice?.delta == null) {\n              return;\n            }\n\n            const delta = choice.delta;\n\n            if (delta.content != null) {\n              controller.enqueue({\n                type: 'text-delta',\n                textDelta: delta.content,\n              });\n            }\n\n            const mappedLogprobs = mapOpenAIChatLogProbsOutput(\n              choice?.logprobs,\n            );\n            if (mappedLogprobs?.length) {\n              if (logprobs === undefined) logprobs = [];\n              logprobs.push(...mappedLogprobs);\n            }\n\n            const mappedToolCalls: typeof delta.tool_calls =\n              useLegacyFunctionCalling && delta.function_call != null\n                ? [\n                    {\n                      type: 'function',\n                      id: generateId(),\n                      function: delta.function_call,\n                      index: 0,\n                    },\n                  ]\n                : delta.tool_calls;\n\n            if (mappedToolCalls != null) {\n              for (const toolCallDelta of mappedToolCalls) {\n                const index = toolCallDelta.index;\n\n                // Tool call start. OpenAI returns all information except the arguments in the first chunk.\n                if (toolCalls[index] == null) {\n                  if (toolCallDelta.type !== 'function') {\n                    throw new InvalidResponseDataError({\n                      data: toolCallDelta,\n                      message: `Expected 'function' type.`,\n                    });\n                  }\n\n                  if (toolCallDelta.id == null) {\n                    throw new InvalidResponseDataError({\n                      data: toolCallDelta,\n                      message: `Expected 'id' to be a string.`,\n                    });\n                  }\n\n                  if (toolCallDelta.function?.name == null) {\n                    throw new InvalidResponseDataError({\n                      data: toolCallDelta,\n                      message: `Expected 'function.name' to be a string.`,\n                    });\n                  }\n\n                  toolCalls[index] = {\n                    id: toolCallDelta.id,\n                    type: 'function',\n                    function: {\n                      name: toolCallDelta.function.name,\n                      arguments: toolCallDelta.function.arguments ?? '',\n                    },\n                    hasFinished: false,\n                  };\n\n                  const toolCall = toolCalls[index];\n\n                  if (\n                    toolCall.function?.name != null &&\n                    toolCall.function?.arguments != null\n                  ) {\n                    // send delta if the argument text has already started:\n                    if (toolCall.function.arguments.length > 0) {\n                      controller.enqueue({\n                        type: 'tool-call-delta',\n                        toolCallType: 'function',\n                        toolCallId: toolCall.id,\n                        toolName: toolCall.function.name,\n                        argsTextDelta: toolCall.function.arguments,\n                      });\n                    }\n\n                    // check if tool call is complete\n                    // (some providers send the full tool call in one chunk):\n                    if (isParsableJson(toolCall.function.arguments)) {\n                      controller.enqueue({\n                        type: 'tool-call',\n                        toolCallType: 'function',\n                        toolCallId: toolCall.id ?? generateId(),\n                        toolName: toolCall.function.name,\n                        args: toolCall.function.arguments,\n                      });\n                      toolCall.hasFinished = true;\n                    }\n                  }\n\n                  continue;\n                }\n\n                // existing tool call, merge if not finished\n                const toolCall = toolCalls[index];\n\n                if (toolCall.hasFinished) {\n                  continue;\n                }\n\n                if (toolCallDelta.function?.arguments != null) {\n                  toolCall.function!.arguments +=\n                    toolCallDelta.function?.arguments ?? '';\n                }\n\n                // send delta\n                controller.enqueue({\n                  type: 'tool-call-delta',\n                  toolCallType: 'function',\n                  toolCallId: toolCall.id,\n                  toolName: toolCall.function.name,\n                  argsTextDelta: toolCallDelta.function.arguments ?? '',\n                });\n\n                // check if tool call is complete\n                if (\n                  toolCall.function?.name != null &&\n                  toolCall.function?.arguments != null &&\n                  isParsableJson(toolCall.function.arguments)\n                ) {\n                  controller.enqueue({\n                    type: 'tool-call',\n                    toolCallType: 'function',\n                    toolCallId: toolCall.id ?? generateId(),\n                    toolName: toolCall.function.name,\n                    args: toolCall.function.arguments,\n                  });\n                  toolCall.hasFinished = true;\n                }\n              }\n            }\n          },\n\n          flush(controller) {\n            controller.enqueue({\n              type: 'finish',\n              finishReason,\n              logprobs,\n              usage: {\n                promptTokens: usage.promptTokens ?? NaN,\n                completionTokens: usage.completionTokens ?? NaN,\n              },\n              ...(providerMetadata != null ? { providerMetadata } : {}),\n            });\n          },\n        }),\n      ),\n      rawCall: { rawPrompt, rawSettings },\n      rawResponse: { headers: responseHeaders },\n      request: { body: JSON.stringify(body) },\n      warnings,\n    };\n  }\n}\n\nconst openaiTokenUsageSchema = z\n  .object({\n    prompt_tokens: z.number().nullish(),\n    completion_tokens: z.number().nullish(),\n    prompt_tokens_details: z\n      .object({\n        cached_tokens: z.number().nullish(),\n      })\n      .nullish(),\n    completion_tokens_details: z\n      .object({\n        reasoning_tokens: z.number().nullish(),\n      })\n      .nullish(),\n  })\n  .nullish();\n\n// limited version of the schema, focussed on what is needed for the implementation\n// this approach limits breakages when the API changes and increases efficiency\nconst openaiChatResponseSchema = z.object({\n  id: z.string().nullish(),\n  created: z.number().nullish(),\n  model: z.string().nullish(),\n  choices: z.array(\n    z.object({\n      message: z.object({\n        role: z.literal('assistant').nullish(),\n        content: z.string().nullish(),\n        function_call: z\n          .object({\n            arguments: z.string(),\n            name: z.string(),\n          })\n          .nullish(),\n        tool_calls: z\n          .array(\n            z.object({\n              id: z.string().nullish(),\n              type: z.literal('function'),\n              function: z.object({\n                name: z.string(),\n                arguments: z.string(),\n              }),\n            }),\n          )\n          .nullish(),\n      }),\n      index: z.number(),\n      logprobs: z\n        .object({\n          content: z\n            .array(\n              z.object({\n                token: z.string(),\n                logprob: z.number(),\n                top_logprobs: z.array(\n                  z.object({\n                    token: z.string(),\n                    logprob: z.number(),\n                  }),\n                ),\n              }),\n            )\n            .nullable(),\n        })\n        .nullish(),\n      finish_reason: z.string().nullish(),\n    }),\n  ),\n  usage: openaiTokenUsageSchema,\n});\n\n// limited version of the schema, focussed on what is needed for the implementation\n// this approach limits breakages when the API changes and increases efficiency\nconst openaiChatChunkSchema = z.union([\n  z.object({\n    id: z.string().nullish(),\n    created: z.number().nullish(),\n    model: z.string().nullish(),\n    choices: z.array(\n      z.object({\n        delta: z\n          .object({\n            role: z.enum(['assistant']).nullish(),\n            content: z.string().nullish(),\n            function_call: z\n              .object({\n                name: z.string().optional(),\n                arguments: z.string().optional(),\n              })\n              .nullish(),\n            tool_calls: z\n              .array(\n                z.object({\n                  index: z.number(),\n                  id: z.string().nullish(),\n                  type: z.literal('function').optional(),\n                  function: z.object({\n                    name: z.string().nullish(),\n                    arguments: z.string().nullish(),\n                  }),\n                }),\n              )\n              .nullish(),\n          })\n          .nullish(),\n        logprobs: z\n          .object({\n            content: z\n              .array(\n                z.object({\n                  token: z.string(),\n                  logprob: z.number(),\n                  top_logprobs: z.array(\n                    z.object({\n                      token: z.string(),\n                      logprob: z.number(),\n                    }),\n                  ),\n                }),\n              )\n              .nullable(),\n          })\n          .nullish(),\n        finish_reason: z.string().nullable().optional(),\n        index: z.number(),\n      }),\n    ),\n    usage: openaiTokenUsageSchema,\n  }),\n  openaiErrorDataSchema,\n]);\n\nfunction isReasoningModel(modelId: string) {\n  return modelId.startsWith('o1-');\n}\n\nfunction isAudioModel(modelId: string) {\n  return modelId.startsWith('gpt-4o-audio-preview');\n}\n","import {\n  LanguageModelV1Prompt,\n  UnsupportedFunctionalityError,\n} from '@ai-sdk/provider';\nimport { convertUint8ArrayToBase64 } from '@ai-sdk/provider-utils';\nimport { OpenAIChatPrompt } from './openai-chat-prompt';\n\nexport function convertToOpenAIChatMessages({\n  prompt,\n  useLegacyFunctionCalling = false,\n}: {\n  prompt: LanguageModelV1Prompt;\n  useLegacyFunctionCalling?: boolean;\n}): OpenAIChatPrompt {\n  const messages: OpenAIChatPrompt = [];\n\n  for (const { role, content } of prompt) {\n    switch (role) {\n      case 'system': {\n        messages.push({ role: 'system', content });\n        break;\n      }\n\n      case 'user': {\n        if (content.length === 1 && content[0].type === 'text') {\n          messages.push({ role: 'user', content: content[0].text });\n          break;\n        }\n\n        messages.push({\n          role: 'user',\n          content: content.map(part => {\n            switch (part.type) {\n              case 'text': {\n                return { type: 'text', text: part.text };\n              }\n              case 'image': {\n                return {\n                  type: 'image_url',\n                  image_url: {\n                    url:\n                      part.image instanceof URL\n                        ? part.image.toString()\n                        : `data:${\n                            part.mimeType ?? 'image/jpeg'\n                          };base64,${convertUint8ArrayToBase64(part.image)}`,\n\n                    // OpenAI specific extension: image detail\n                    detail: part.providerMetadata?.openai?.imageDetail,\n                  },\n                };\n              }\n              case 'file': {\n                if (part.data instanceof URL) {\n                  throw new UnsupportedFunctionalityError({\n                    functionality:\n                      \"'File content parts with URL data' functionality not supported.\",\n                  });\n                }\n\n                switch (part.mimeType) {\n                  case 'audio/wav': {\n                    return {\n                      type: 'input_audio',\n                      input_audio: { data: part.data, format: 'wav' },\n                    };\n                  }\n                  case 'audio/mp3':\n                  case 'audio/mpeg': {\n                    return {\n                      type: 'input_audio',\n                      input_audio: { data: part.data, format: 'mp3' },\n                    };\n                  }\n\n                  default: {\n                    throw new UnsupportedFunctionalityError({\n                      functionality: `File content part type ${part.mimeType} in user messages`,\n                    });\n                  }\n                }\n              }\n            }\n          }),\n        });\n\n        break;\n      }\n\n      case 'assistant': {\n        let text = '';\n        const toolCalls: Array<{\n          id: string;\n          type: 'function';\n          function: { name: string; arguments: string };\n        }> = [];\n\n        for (const part of content) {\n          switch (part.type) {\n            case 'text': {\n              text += part.text;\n              break;\n            }\n            case 'tool-call': {\n              toolCalls.push({\n                id: part.toolCallId,\n                type: 'function',\n                function: {\n                  name: part.toolName,\n                  arguments: JSON.stringify(part.args),\n                },\n              });\n              break;\n            }\n            default: {\n              const _exhaustiveCheck: never = part;\n              throw new Error(`Unsupported part: ${_exhaustiveCheck}`);\n            }\n          }\n        }\n\n        if (useLegacyFunctionCalling) {\n          if (toolCalls.length > 1) {\n            throw new UnsupportedFunctionalityError({\n              functionality:\n                'useLegacyFunctionCalling with multiple tool calls in one message',\n            });\n          }\n\n          messages.push({\n            role: 'assistant',\n            content: text,\n            function_call:\n              toolCalls.length > 0 ? toolCalls[0].function : undefined,\n          });\n        } else {\n          messages.push({\n            role: 'assistant',\n            content: text,\n            tool_calls: toolCalls.length > 0 ? toolCalls : undefined,\n          });\n        }\n\n        break;\n      }\n\n      case 'tool': {\n        for (const toolResponse of content) {\n          if (useLegacyFunctionCalling) {\n            messages.push({\n              role: 'function',\n              name: toolResponse.toolName,\n              content: JSON.stringify(toolResponse.result),\n            });\n          } else {\n            messages.push({\n              role: 'tool',\n              tool_call_id: toolResponse.toolCallId,\n              content: JSON.stringify(toolResponse.result),\n            });\n          }\n        }\n        break;\n      }\n\n      default: {\n        const _exhaustiveCheck: never = role;\n        throw new Error(`Unsupported role: ${_exhaustiveCheck}`);\n      }\n    }\n  }\n\n  return messages;\n}\n","import { LanguageModelV1LogProbs } from '@ai-sdk/provider';\n\ntype OpenAIChatLogProbs = {\n  content:\n    | {\n        token: string;\n        logprob: number;\n        top_logprobs:\n          | {\n              token: string;\n              logprob: number;\n            }[]\n          | null;\n      }[]\n    | null;\n};\n\nexport function mapOpenAIChatLogProbsOutput(\n  logprobs: OpenAIChatLogProbs | null | undefined,\n): LanguageModelV1LogProbs | undefined {\n  return (\n    logprobs?.content?.map(({ token, logprob, top_logprobs }) => ({\n      token,\n      logprob,\n      topLogprobs: top_logprobs\n        ? top_logprobs.map(({ token, logprob }) => ({\n            token,\n            logprob,\n          }))\n        : [],\n    })) ?? undefined\n  );\n}\n","import { LanguageModelV1FinishReason } from '@ai-sdk/provider';\n\nexport function mapOpenAIFinishReason(\n  finishReason: string | null | undefined,\n): LanguageModelV1FinishReason {\n  switch (finishReason) {\n    case 'stop':\n      return 'stop';\n    case 'length':\n      return 'length';\n    case 'content_filter':\n      return 'content-filter';\n    case 'function_call':\n    case 'tool_calls':\n      return 'tool-calls';\n    default:\n      return 'unknown';\n  }\n}\n","import { z } from 'zod';\nimport { createJsonErrorResponseHandler } from '@ai-sdk/provider-utils';\n\nexport const openaiErrorDataSchema = z.object({\n  error: z.object({\n    message: z.string(),\n\n    // The additional information below is handled loosely to support\n    // OpenAI-compatible providers that have slightly different error\n    // responses:\n    type: z.string().nullish(),\n    param: z.any().nullish(),\n    code: z.union([z.string(), z.number()]).nullish(),\n  }),\n});\n\nexport type OpenAIErrorData = z.infer<typeof openaiErrorDataSchema>;\n\nexport const openaiFailedResponseHandler = createJsonErrorResponseHandler({\n  errorSchema: openaiErrorDataSchema,\n  errorToMessage: data => data.error.message,\n});\n","export function getResponseMetadata({\n  id,\n  model,\n  created,\n}: {\n  id?: string | undefined | null;\n  created?: number | undefined | null;\n  model?: string | undefined | null;\n}) {\n  return {\n    id: id ?? undefined,\n    modelId: model ?? undefined,\n    timestamp: created != null ? new Date(created * 1000) : undefined,\n  };\n}\n","import {\n  JSONSchema7,\n  LanguageModelV1,\n  LanguageModelV1CallWarning,\n  UnsupportedFunctionalityError,\n} from '@ai-sdk/provider';\n\nexport function prepareTools({\n  mode,\n  useLegacyFunctionCalling = false,\n  structuredOutputs,\n}: {\n  mode: Parameters<LanguageModelV1['doGenerate']>[0]['mode'] & {\n    type: 'regular';\n  };\n  useLegacyFunctionCalling: boolean | undefined;\n  structuredOutputs: boolean;\n}): {\n  tools?: {\n    type: 'function';\n    function: {\n      name: string;\n      description: string | undefined;\n      parameters: JSONSchema7;\n      strict?: boolean;\n    };\n  }[];\n  tool_choice?:\n    | 'auto'\n    | 'none'\n    | 'required'\n    | { type: 'function'; function: { name: string } };\n\n  // legacy support\n  functions?: {\n    name: string;\n    description: string | undefined;\n    parameters: JSONSchema7;\n  }[];\n  function_call?: { name: string };\n\n  toolWarnings: LanguageModelV1CallWarning[];\n} {\n  // when the tools array is empty, change it to undefined to prevent errors:\n  const tools = mode.tools?.length ? mode.tools : undefined;\n\n  const toolWarnings: LanguageModelV1CallWarning[] = [];\n\n  if (tools == null) {\n    return { tools: undefined, tool_choice: undefined, toolWarnings };\n  }\n\n  const toolChoice = mode.toolChoice;\n\n  if (useLegacyFunctionCalling) {\n    const openaiFunctions: Array<{\n      name: string;\n      description: string | undefined;\n      parameters: JSONSchema7;\n    }> = [];\n\n    for (const tool of tools) {\n      if (tool.type === 'provider-defined') {\n        toolWarnings.push({ type: 'unsupported-tool', tool });\n      } else {\n        openaiFunctions.push({\n          name: tool.name,\n          description: tool.description,\n          parameters: tool.parameters,\n        });\n      }\n    }\n\n    if (toolChoice == null) {\n      return {\n        functions: openaiFunctions,\n        function_call: undefined,\n        toolWarnings,\n      };\n    }\n\n    const type = toolChoice.type;\n\n    switch (type) {\n      case 'auto':\n      case 'none':\n      case undefined:\n        return {\n          functions: openaiFunctions,\n          function_call: undefined,\n          toolWarnings,\n        };\n      case 'required':\n        throw new UnsupportedFunctionalityError({\n          functionality: 'useLegacyFunctionCalling and toolChoice: required',\n        });\n      default:\n        return {\n          functions: openaiFunctions,\n          function_call: { name: toolChoice.toolName },\n          toolWarnings,\n        };\n    }\n  }\n\n  const openaiTools: Array<{\n    type: 'function';\n    function: {\n      name: string;\n      description: string | undefined;\n      parameters: JSONSchema7;\n      strict: boolean | undefined;\n    };\n  }> = [];\n\n  for (const tool of tools) {\n    if (tool.type === 'provider-defined') {\n      toolWarnings.push({ type: 'unsupported-tool', tool });\n    } else {\n      openaiTools.push({\n        type: 'function',\n        function: {\n          name: tool.name,\n          description: tool.description,\n          parameters: tool.parameters,\n          strict: structuredOutputs ? true : undefined,\n        },\n      });\n    }\n  }\n\n  if (toolChoice == null) {\n    return { tools: openaiTools, tool_choice: undefined, toolWarnings };\n  }\n\n  const type = toolChoice.type;\n\n  switch (type) {\n    case 'auto':\n    case 'none':\n    case 'required':\n      return { tools: openaiTools, tool_choice: type, toolWarnings };\n    case 'tool':\n      return {\n        tools: openaiTools,\n        tool_choice: {\n          type: 'function',\n          function: {\n            name: toolChoice.toolName,\n          },\n        },\n        toolWarnings,\n      };\n    default: {\n      const _exhaustiveCheck: never = type;\n      throw new UnsupportedFunctionalityError({\n        functionality: `Unsupported tool choice type: ${_exhaustiveCheck}`,\n      });\n    }\n  }\n}\n","import {\n  LanguageModelV1,\n  LanguageModelV1CallWarning,\n  LanguageModelV1FinishReason,\n  LanguageModelV1LogProbs,\n  LanguageModelV1StreamPart,\n  UnsupportedFunctionalityError,\n} from '@ai-sdk/provider';\nimport {\n  FetchFunction,\n  ParseResult,\n  combineHeaders,\n  createEventSourceResponseHandler,\n  createJsonResponseHandler,\n  postJsonToApi,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod';\nimport { convertToOpenAICompletionPrompt } from './convert-to-openai-completion-prompt';\nimport { mapOpenAICompletionLogProbs } from './map-openai-completion-logprobs';\nimport { mapOpenAIFinishReason } from './map-openai-finish-reason';\nimport {\n  OpenAICompletionModelId,\n  OpenAICompletionSettings,\n} from './openai-completion-settings';\nimport {\n  openaiErrorDataSchema,\n  openaiFailedResponseHandler,\n} from './openai-error';\nimport { getResponseMetadata } from './get-response-metadata';\n\ntype OpenAICompletionConfig = {\n  provider: string;\n  compatibility: 'strict' | 'compatible';\n  headers: () => Record<string, string | undefined>;\n  url: (options: { modelId: string; path: string }) => string;\n  fetch?: FetchFunction;\n};\n\nexport class OpenAICompletionLanguageModel implements LanguageModelV1 {\n  readonly specificationVersion = 'v1';\n  readonly defaultObjectGenerationMode = undefined;\n\n  readonly modelId: OpenAICompletionModelId;\n  readonly settings: OpenAICompletionSettings;\n\n  private readonly config: OpenAICompletionConfig;\n\n  constructor(\n    modelId: OpenAICompletionModelId,\n    settings: OpenAICompletionSettings,\n    config: OpenAICompletionConfig,\n  ) {\n    this.modelId = modelId;\n    this.settings = settings;\n    this.config = config;\n  }\n\n  get provider(): string {\n    return this.config.provider;\n  }\n\n  private getArgs({\n    mode,\n    inputFormat,\n    prompt,\n    maxTokens,\n    temperature,\n    topP,\n    topK,\n    frequencyPenalty,\n    presencePenalty,\n    stopSequences: userStopSequences,\n    responseFormat,\n    seed,\n  }: Parameters<LanguageModelV1['doGenerate']>[0]) {\n    const type = mode.type;\n\n    const warnings: LanguageModelV1CallWarning[] = [];\n\n    if (topK != null) {\n      warnings.push({\n        type: 'unsupported-setting',\n        setting: 'topK',\n      });\n    }\n\n    if (responseFormat != null && responseFormat.type !== 'text') {\n      warnings.push({\n        type: 'unsupported-setting',\n        setting: 'responseFormat',\n        details: 'JSON response format is not supported.',\n      });\n    }\n\n    const { prompt: completionPrompt, stopSequences } =\n      convertToOpenAICompletionPrompt({ prompt, inputFormat });\n\n    const stop = [...(stopSequences ?? []), ...(userStopSequences ?? [])];\n\n    const baseArgs = {\n      // model id:\n      model: this.modelId,\n\n      // model specific settings:\n      echo: this.settings.echo,\n      logit_bias: this.settings.logitBias,\n      logprobs:\n        typeof this.settings.logprobs === 'number'\n          ? this.settings.logprobs\n          : typeof this.settings.logprobs === 'boolean'\n          ? this.settings.logprobs\n            ? 0\n            : undefined\n          : undefined,\n      suffix: this.settings.suffix,\n      user: this.settings.user,\n\n      // standardized settings:\n      max_tokens: maxTokens,\n      temperature,\n      top_p: topP,\n      frequency_penalty: frequencyPenalty,\n      presence_penalty: presencePenalty,\n      seed,\n\n      // prompt:\n      prompt: completionPrompt,\n\n      // stop sequences:\n      stop: stop.length > 0 ? stop : undefined,\n    };\n\n    switch (type) {\n      case 'regular': {\n        if (mode.tools?.length) {\n          throw new UnsupportedFunctionalityError({\n            functionality: 'tools',\n          });\n        }\n\n        if (mode.toolChoice) {\n          throw new UnsupportedFunctionalityError({\n            functionality: 'toolChoice',\n          });\n        }\n\n        return { args: baseArgs, warnings };\n      }\n\n      case 'object-json': {\n        throw new UnsupportedFunctionalityError({\n          functionality: 'object-json mode',\n        });\n      }\n\n      case 'object-tool': {\n        throw new UnsupportedFunctionalityError({\n          functionality: 'object-tool mode',\n        });\n      }\n\n      default: {\n        const _exhaustiveCheck: never = type;\n        throw new Error(`Unsupported type: ${_exhaustiveCheck}`);\n      }\n    }\n  }\n\n  async doGenerate(\n    options: Parameters<LanguageModelV1['doGenerate']>[0],\n  ): Promise<Awaited<ReturnType<LanguageModelV1['doGenerate']>>> {\n    const { args, warnings } = this.getArgs(options);\n\n    const { responseHeaders, value: response } = await postJsonToApi({\n      url: this.config.url({\n        path: '/completions',\n        modelId: this.modelId,\n      }),\n      headers: combineHeaders(this.config.headers(), options.headers),\n      body: args,\n      failedResponseHandler: openaiFailedResponseHandler,\n      successfulResponseHandler: createJsonResponseHandler(\n        openaiCompletionResponseSchema,\n      ),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch,\n    });\n\n    const { prompt: rawPrompt, ...rawSettings } = args;\n    const choice = response.choices[0];\n\n    return {\n      text: choice.text,\n      usage: {\n        promptTokens: response.usage.prompt_tokens,\n        completionTokens: response.usage.completion_tokens,\n      },\n      finishReason: mapOpenAIFinishReason(choice.finish_reason),\n      logprobs: mapOpenAICompletionLogProbs(choice.logprobs),\n      rawCall: { rawPrompt, rawSettings },\n      rawResponse: { headers: responseHeaders },\n      response: getResponseMetadata(response),\n      warnings,\n      request: { body: JSON.stringify(args) },\n    };\n  }\n\n  async doStream(\n    options: Parameters<LanguageModelV1['doStream']>[0],\n  ): Promise<Awaited<ReturnType<LanguageModelV1['doStream']>>> {\n    const { args, warnings } = this.getArgs(options);\n\n    const body = {\n      ...args,\n      stream: true,\n\n      // only include stream_options when in strict compatibility mode:\n      stream_options:\n        this.config.compatibility === 'strict'\n          ? { include_usage: true }\n          : undefined,\n    };\n\n    const { responseHeaders, value: response } = await postJsonToApi({\n      url: this.config.url({\n        path: '/completions',\n        modelId: this.modelId,\n      }),\n      headers: combineHeaders(this.config.headers(), options.headers),\n      body,\n      failedResponseHandler: openaiFailedResponseHandler,\n      successfulResponseHandler: createEventSourceResponseHandler(\n        openaiCompletionChunkSchema,\n      ),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch,\n    });\n\n    const { prompt: rawPrompt, ...rawSettings } = args;\n\n    let finishReason: LanguageModelV1FinishReason = 'unknown';\n    let usage: { promptTokens: number; completionTokens: number } = {\n      promptTokens: Number.NaN,\n      completionTokens: Number.NaN,\n    };\n    let logprobs: LanguageModelV1LogProbs;\n    let isFirstChunk = true;\n\n    return {\n      stream: response.pipeThrough(\n        new TransformStream<\n          ParseResult<z.infer<typeof openaiCompletionChunkSchema>>,\n          LanguageModelV1StreamPart\n        >({\n          transform(chunk, controller) {\n            // handle failed chunk parsing / validation:\n            if (!chunk.success) {\n              finishReason = 'error';\n              controller.enqueue({ type: 'error', error: chunk.error });\n              return;\n            }\n\n            const value = chunk.value;\n\n            // handle error chunks:\n            if ('error' in value) {\n              finishReason = 'error';\n              controller.enqueue({ type: 'error', error: value.error });\n              return;\n            }\n\n            if (isFirstChunk) {\n              isFirstChunk = false;\n\n              controller.enqueue({\n                type: 'response-metadata',\n                ...getResponseMetadata(value),\n              });\n            }\n\n            if (value.usage != null) {\n              usage = {\n                promptTokens: value.usage.prompt_tokens,\n                completionTokens: value.usage.completion_tokens,\n              };\n            }\n\n            const choice = value.choices[0];\n\n            if (choice?.finish_reason != null) {\n              finishReason = mapOpenAIFinishReason(choice.finish_reason);\n            }\n\n            if (choice?.text != null) {\n              controller.enqueue({\n                type: 'text-delta',\n                textDelta: choice.text,\n              });\n            }\n\n            const mappedLogprobs = mapOpenAICompletionLogProbs(\n              choice?.logprobs,\n            );\n            if (mappedLogprobs?.length) {\n              if (logprobs === undefined) logprobs = [];\n              logprobs.push(...mappedLogprobs);\n            }\n          },\n\n          flush(controller) {\n            controller.enqueue({\n              type: 'finish',\n              finishReason,\n              logprobs,\n              usage,\n            });\n          },\n        }),\n      ),\n      rawCall: { rawPrompt, rawSettings },\n      rawResponse: { headers: responseHeaders },\n      warnings,\n      request: { body: JSON.stringify(body) },\n    };\n  }\n}\n\n// limited version of the schema, focussed on what is needed for the implementation\n// this approach limits breakages when the API changes and increases efficiency\nconst openaiCompletionResponseSchema = z.object({\n  id: z.string().nullish(),\n  created: z.number().nullish(),\n  model: z.string().nullish(),\n  choices: z.array(\n    z.object({\n      text: z.string(),\n      finish_reason: z.string(),\n      logprobs: z\n        .object({\n          tokens: z.array(z.string()),\n          token_logprobs: z.array(z.number()),\n          top_logprobs: z.array(z.record(z.string(), z.number())).nullable(),\n        })\n        .nullish(),\n    }),\n  ),\n  usage: z.object({\n    prompt_tokens: z.number(),\n    completion_tokens: z.number(),\n  }),\n});\n\n// limited version of the schema, focussed on what is needed for the implementation\n// this approach limits breakages when the API changes and increases efficiency\nconst openaiCompletionChunkSchema = z.union([\n  z.object({\n    id: z.string().nullish(),\n    created: z.number().nullish(),\n    model: z.string().nullish(),\n    choices: z.array(\n      z.object({\n        text: z.string(),\n        finish_reason: z.string().nullish(),\n        index: z.number(),\n        logprobs: z\n          .object({\n            tokens: z.array(z.string()),\n            token_logprobs: z.array(z.number()),\n            top_logprobs: z.array(z.record(z.string(), z.number())).nullable(),\n          })\n          .nullish(),\n      }),\n    ),\n    usage: z\n      .object({\n        prompt_tokens: z.number(),\n        completion_tokens: z.number(),\n      })\n      .nullish(),\n  }),\n  openaiErrorDataSchema,\n]);\n","import {\n  InvalidPromptError,\n  LanguageModelV1Prompt,\n  UnsupportedFunctionalityError,\n} from '@ai-sdk/provider';\n\nexport function convertToOpenAICompletionPrompt({\n  prompt,\n  inputFormat,\n  user = 'user',\n  assistant = 'assistant',\n}: {\n  prompt: LanguageModelV1Prompt;\n  inputFormat: 'prompt' | 'messages';\n  user?: string;\n  assistant?: string;\n}): {\n  prompt: string;\n  stopSequences?: string[];\n} {\n  // When the user supplied a prompt input, we don't transform it:\n  if (\n    inputFormat === 'prompt' &&\n    prompt.length === 1 &&\n    prompt[0].role === 'user' &&\n    prompt[0].content.length === 1 &&\n    prompt[0].content[0].type === 'text'\n  ) {\n    return { prompt: prompt[0].content[0].text };\n  }\n\n  // otherwise transform to a chat message format:\n  let text = '';\n\n  // if first message is a system message, add it to the text:\n  if (prompt[0].role === 'system') {\n    text += `${prompt[0].content}\\n\\n`;\n    prompt = prompt.slice(1);\n  }\n\n  for (const { role, content } of prompt) {\n    switch (role) {\n      case 'system': {\n        throw new InvalidPromptError({\n          message: 'Unexpected system message in prompt: ${content}',\n          prompt,\n        });\n      }\n\n      case 'user': {\n        const userMessage = content\n          .map(part => {\n            switch (part.type) {\n              case 'text': {\n                return part.text;\n              }\n              case 'image': {\n                throw new UnsupportedFunctionalityError({\n                  functionality: 'images',\n                });\n              }\n            }\n          })\n          .join('');\n\n        text += `${user}:\\n${userMessage}\\n\\n`;\n        break;\n      }\n\n      case 'assistant': {\n        const assistantMessage = content\n          .map(part => {\n            switch (part.type) {\n              case 'text': {\n                return part.text;\n              }\n              case 'tool-call': {\n                throw new UnsupportedFunctionalityError({\n                  functionality: 'tool-call messages',\n                });\n              }\n            }\n          })\n          .join('');\n\n        text += `${assistant}:\\n${assistantMessage}\\n\\n`;\n        break;\n      }\n\n      case 'tool': {\n        throw new UnsupportedFunctionalityError({\n          functionality: 'tool messages',\n        });\n      }\n\n      default: {\n        const _exhaustiveCheck: never = role;\n        throw new Error(`Unsupported role: ${_exhaustiveCheck}`);\n      }\n    }\n  }\n\n  // Assistant message prefix:\n  text += `${assistant}:\\n`;\n\n  return {\n    prompt: text,\n    stopSequences: [`\\n${user}:`],\n  };\n}\n","import { LanguageModelV1LogProbs } from '@ai-sdk/provider';\n\ntype OpenAICompletionLogProps = {\n  tokens: string[];\n  token_logprobs: number[];\n  top_logprobs: Record<string, number>[] | null;\n};\n\nexport function mapOpenAICompletionLogProbs(\n  logprobs: OpenAICompletionLogProps | null | undefined,\n): LanguageModelV1LogProbs | undefined {\n  return logprobs?.tokens.map((token, index) => ({\n    token,\n    logprob: logprobs.token_logprobs[index],\n    topLogprobs: logprobs.top_logprobs\n      ? Object.entries(logprobs.top_logprobs[index]).map(\n          ([token, logprob]) => ({\n            token,\n            logprob,\n          }),\n        )\n      : [],\n  }));\n}\n","import {\n  EmbeddingModelV1,\n  TooManyEmbeddingValuesForCallError,\n} from '@ai-sdk/provider';\nimport {\n  combineHeaders,\n  createJsonResponseHandler,\n  FetchFunction,\n  postJsonToApi,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod';\nimport {\n  OpenAIEmbeddingModelId,\n  OpenAIEmbeddingSettings,\n} from './openai-embedding-settings';\nimport { openaiFailedResponseHandler } from './openai-error';\n\ntype OpenAIEmbeddingConfig = {\n  provider: string;\n  url: (options: { modelId: string; path: string }) => string;\n  headers: () => Record<string, string | undefined>;\n  fetch?: FetchFunction;\n};\n\nexport class OpenAIEmbeddingModel implements EmbeddingModelV1<string> {\n  readonly specificationVersion = 'v1';\n  readonly modelId: OpenAIEmbeddingModelId;\n\n  private readonly config: OpenAIEmbeddingConfig;\n  private readonly settings: OpenAIEmbeddingSettings;\n\n  get provider(): string {\n    return this.config.provider;\n  }\n\n  get maxEmbeddingsPerCall(): number {\n    return this.settings.maxEmbeddingsPerCall ?? 2048;\n  }\n\n  get supportsParallelCalls(): boolean {\n    return this.settings.supportsParallelCalls ?? true;\n  }\n\n  constructor(\n    modelId: OpenAIEmbeddingModelId,\n    settings: OpenAIEmbeddingSettings,\n    config: OpenAIEmbeddingConfig,\n  ) {\n    this.modelId = modelId;\n    this.settings = settings;\n    this.config = config;\n  }\n\n  async doEmbed({\n    values,\n    headers,\n    abortSignal,\n  }: Parameters<EmbeddingModelV1<string>['doEmbed']>[0]): Promise<\n    Awaited<ReturnType<EmbeddingModelV1<string>['doEmbed']>>\n  > {\n    if (values.length > this.maxEmbeddingsPerCall) {\n      throw new TooManyEmbeddingValuesForCallError({\n        provider: this.provider,\n        modelId: this.modelId,\n        maxEmbeddingsPerCall: this.maxEmbeddingsPerCall,\n        values,\n      });\n    }\n\n    const { responseHeaders, value: response } = await postJsonToApi({\n      url: this.config.url({\n        path: '/embeddings',\n        modelId: this.modelId,\n      }),\n      headers: combineHeaders(this.config.headers(), headers),\n      body: {\n        model: this.modelId,\n        input: values,\n        encoding_format: 'float',\n        dimensions: this.settings.dimensions,\n        user: this.settings.user,\n      },\n      failedResponseHandler: openaiFailedResponseHandler,\n      successfulResponseHandler: createJsonResponseHandler(\n        openaiTextEmbeddingResponseSchema,\n      ),\n      abortSignal,\n      fetch: this.config.fetch,\n    });\n\n    return {\n      embeddings: response.data.map(item => item.embedding),\n      usage: response.usage\n        ? { tokens: response.usage.prompt_tokens }\n        : undefined,\n      rawResponse: { headers: responseHeaders },\n    };\n  }\n}\n\n// minimal version of the schema, focussed on what is needed for the implementation\n// this approach limits breakages when the API changes and increases efficiency\nconst openaiTextEmbeddingResponseSchema = z.object({\n  data: z.array(z.object({ embedding: z.array(z.number()) })),\n  usage: z.object({ prompt_tokens: z.number() }).nullish(),\n});\n"],"names":["UnsupportedFunctionalityError","z","token","logprob","UnsupportedFunctionalityError","type","UnsupportedFunctionalityError","_a","toolCall","z","UnsupportedFunctionalityError","combineHeaders","createEventSourceResponseHandler","createJsonResponseHandler","postJsonToApi","z","UnsupportedFunctionalityError","token","UnsupportedFunctionalityError","postJsonToApi","combineHeaders","createJsonResponseHandler","createEventSourceResponseHandler","z","combineHeaders","createJsonResponseHandler","postJsonToApi","z","postJsonToApi","combineHeaders","createJsonResponseHandler","z"],"mappings":"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","ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11]}},
    {"offset": {"line": 1430, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 1436, "column": 0}, "map": {"version":3,"sources":["file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/openai-chat-language-model.ts","file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/convert-to-openai-chat-messages.ts","file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/map-openai-chat-logprobs.ts","file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/map-openai-finish-reason.ts","file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/openai-error.ts","file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/get-response-metadata.ts","file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/openai-prepare-tools.ts","file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/openai-completion-language-model.ts","file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/convert-to-openai-completion-prompt.ts","file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/map-openai-completion-logprobs.ts","file:///Users/user/Desktop/code/kepler/future/examples/vnext/node_modules/.pnpm/%40ai-sdk%2Bopenai%401.0.7_zod%403.23.7/node_modules/%40ai-sdk/openai/src/openai-embedding-model.ts"],"sourcesContent":["import {\n  InvalidResponseDataError,\n  LanguageModelV1,\n  LanguageModelV1CallWarning,\n  LanguageModelV1FinishReason,\n  LanguageModelV1LogProbs,\n  LanguageModelV1ProviderMetadata,\n  LanguageModelV1StreamPart,\n  UnsupportedFunctionalityError,\n} from '@ai-sdk/provider';\nimport {\n  FetchFunction,\n  ParseResult,\n  combineHeaders,\n  createEventSourceResponseHandler,\n  createJsonResponseHandler,\n  generateId,\n  isParsableJson,\n  postJsonToApi,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod';\nimport { convertToOpenAIChatMessages } from './convert-to-openai-chat-messages';\nimport { mapOpenAIChatLogProbsOutput } from './map-openai-chat-logprobs';\nimport { mapOpenAIFinishReason } from './map-openai-finish-reason';\nimport { OpenAIChatModelId, OpenAIChatSettings } from './openai-chat-settings';\nimport {\n  openaiErrorDataSchema,\n  openaiFailedResponseHandler,\n} from './openai-error';\nimport { getResponseMetadata } from './get-response-metadata';\nimport { prepareTools } from './openai-prepare-tools';\n\ntype OpenAIChatConfig = {\n  provider: string;\n  compatibility: 'strict' | 'compatible';\n  headers: () => Record<string, string | undefined>;\n  url: (options: { modelId: string; path: string }) => string;\n  fetch?: FetchFunction;\n};\n\nexport class OpenAIChatLanguageModel implements LanguageModelV1 {\n  readonly specificationVersion = 'v1';\n\n  readonly modelId: OpenAIChatModelId;\n  readonly settings: OpenAIChatSettings;\n\n  private readonly config: OpenAIChatConfig;\n\n  constructor(\n    modelId: OpenAIChatModelId,\n    settings: OpenAIChatSettings,\n    config: OpenAIChatConfig,\n  ) {\n    this.modelId = modelId;\n    this.settings = settings;\n    this.config = config;\n  }\n\n  get supportsStructuredOutputs(): boolean {\n    return this.settings.structuredOutputs ?? false;\n  }\n\n  get defaultObjectGenerationMode() {\n    // audio models don't support structured outputs:\n    if (isAudioModel(this.modelId)) {\n      return 'tool';\n    }\n\n    return this.supportsStructuredOutputs ? 'json' : 'tool';\n  }\n\n  get provider(): string {\n    return this.config.provider;\n  }\n\n  get supportsImageUrls(): boolean {\n    // image urls can be sent if downloadImages is disabled (default):\n    return !this.settings.downloadImages;\n  }\n\n  private getArgs({\n    mode,\n    prompt,\n    maxTokens,\n    temperature,\n    topP,\n    topK,\n    frequencyPenalty,\n    presencePenalty,\n    stopSequences,\n    responseFormat,\n    seed,\n    providerMetadata,\n  }: Parameters<LanguageModelV1['doGenerate']>[0]) {\n    const type = mode.type;\n\n    const warnings: LanguageModelV1CallWarning[] = [];\n\n    if (topK != null) {\n      warnings.push({\n        type: 'unsupported-setting',\n        setting: 'topK',\n      });\n    }\n\n    if (\n      responseFormat?.type === 'json' &&\n      responseFormat.schema != null &&\n      !this.supportsStructuredOutputs\n    ) {\n      warnings.push({\n        type: 'unsupported-setting',\n        setting: 'responseFormat',\n        details:\n          'JSON response format schema is only supported with structuredOutputs',\n      });\n    }\n\n    const useLegacyFunctionCalling = this.settings.useLegacyFunctionCalling;\n\n    if (useLegacyFunctionCalling && this.settings.parallelToolCalls === true) {\n      throw new UnsupportedFunctionalityError({\n        functionality: 'useLegacyFunctionCalling with parallelToolCalls',\n      });\n    }\n\n    if (useLegacyFunctionCalling && this.supportsStructuredOutputs) {\n      throw new UnsupportedFunctionalityError({\n        functionality: 'structuredOutputs with useLegacyFunctionCalling',\n      });\n    }\n\n    const baseArgs = {\n      // model id:\n      model: this.modelId,\n\n      // model specific settings:\n      logit_bias: this.settings.logitBias,\n      logprobs:\n        this.settings.logprobs === true ||\n        typeof this.settings.logprobs === 'number'\n          ? true\n          : undefined,\n      top_logprobs:\n        typeof this.settings.logprobs === 'number'\n          ? this.settings.logprobs\n          : typeof this.settings.logprobs === 'boolean'\n          ? this.settings.logprobs\n            ? 0\n            : undefined\n          : undefined,\n      user: this.settings.user,\n      parallel_tool_calls: this.settings.parallelToolCalls,\n\n      // standardized settings:\n      max_tokens: maxTokens,\n      temperature,\n      top_p: topP,\n      frequency_penalty: frequencyPenalty,\n      presence_penalty: presencePenalty,\n      response_format:\n        responseFormat?.type === 'json'\n          ? this.supportsStructuredOutputs && responseFormat.schema != null\n            ? {\n                type: 'json_schema',\n                json_schema: {\n                  schema: responseFormat.schema,\n                  strict: true,\n                  name: responseFormat.name ?? 'response',\n                  description: responseFormat.description,\n                },\n              }\n            : { type: 'json_object' }\n          : undefined,\n      stop: stopSequences,\n      seed,\n\n      // openai specific settings:\n      max_completion_tokens:\n        providerMetadata?.openai?.maxCompletionTokens ?? undefined,\n      store: providerMetadata?.openai?.store ?? undefined,\n      metadata: providerMetadata?.openai?.metadata ?? undefined,\n      prediction: providerMetadata?.openai?.prediction ?? undefined,\n\n      // messages:\n      messages: convertToOpenAIChatMessages({\n        prompt,\n        useLegacyFunctionCalling,\n      }),\n    };\n\n    // reasoning models have fixed params, remove them if they are set:\n    if (isReasoningModel(this.modelId)) {\n      baseArgs.temperature = undefined;\n      baseArgs.top_p = undefined;\n      baseArgs.frequency_penalty = undefined;\n      baseArgs.presence_penalty = undefined;\n    }\n\n    switch (type) {\n      case 'regular': {\n        const { tools, tool_choice, functions, function_call, toolWarnings } =\n          prepareTools({\n            mode,\n            useLegacyFunctionCalling,\n            structuredOutputs: this.supportsStructuredOutputs,\n          });\n\n        return {\n          args: {\n            ...baseArgs,\n            tools,\n            tool_choice,\n            functions,\n            function_call,\n          },\n          warnings: [...warnings, ...toolWarnings],\n        };\n      }\n\n      case 'object-json': {\n        return {\n          args: {\n            ...baseArgs,\n            response_format:\n              this.supportsStructuredOutputs && mode.schema != null\n                ? {\n                    type: 'json_schema',\n                    json_schema: {\n                      schema: mode.schema,\n                      strict: true,\n                      name: mode.name ?? 'response',\n                      description: mode.description,\n                    },\n                  }\n                : { type: 'json_object' },\n          },\n          warnings,\n        };\n      }\n\n      case 'object-tool': {\n        return {\n          args: useLegacyFunctionCalling\n            ? {\n                ...baseArgs,\n                function_call: {\n                  name: mode.tool.name,\n                },\n                functions: [\n                  {\n                    name: mode.tool.name,\n                    description: mode.tool.description,\n                    parameters: mode.tool.parameters,\n                  },\n                ],\n              }\n            : {\n                ...baseArgs,\n                tool_choice: {\n                  type: 'function',\n                  function: { name: mode.tool.name },\n                },\n                tools: [\n                  {\n                    type: 'function',\n                    function: {\n                      name: mode.tool.name,\n                      description: mode.tool.description,\n                      parameters: mode.tool.parameters,\n                      strict: this.supportsStructuredOutputs ? true : undefined,\n                    },\n                  },\n                ],\n              },\n          warnings,\n        };\n      }\n\n      default: {\n        const _exhaustiveCheck: never = type;\n        throw new Error(`Unsupported type: ${_exhaustiveCheck}`);\n      }\n    }\n  }\n\n  async doGenerate(\n    options: Parameters<LanguageModelV1['doGenerate']>[0],\n  ): Promise<Awaited<ReturnType<LanguageModelV1['doGenerate']>>> {\n    const { args: body, warnings } = this.getArgs(options);\n\n    const { responseHeaders, value: response } = await postJsonToApi({\n      url: this.config.url({\n        path: '/chat/completions',\n        modelId: this.modelId,\n      }),\n      headers: combineHeaders(this.config.headers(), options.headers),\n      body,\n      failedResponseHandler: openaiFailedResponseHandler,\n      successfulResponseHandler: createJsonResponseHandler(\n        openaiChatResponseSchema,\n      ),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch,\n    });\n\n    const { messages: rawPrompt, ...rawSettings } = body;\n    const choice = response.choices[0];\n\n    let providerMetadata: LanguageModelV1ProviderMetadata | undefined;\n    if (\n      response.usage?.completion_tokens_details?.reasoning_tokens != null ||\n      response.usage?.prompt_tokens_details?.cached_tokens != null\n    ) {\n      providerMetadata = { openai: {} };\n      if (response.usage?.completion_tokens_details?.reasoning_tokens != null) {\n        providerMetadata.openai.reasoningTokens =\n          response.usage?.completion_tokens_details?.reasoning_tokens;\n      }\n      if (response.usage?.prompt_tokens_details?.cached_tokens != null) {\n        providerMetadata.openai.cachedPromptTokens =\n          response.usage?.prompt_tokens_details?.cached_tokens;\n      }\n    }\n\n    return {\n      text: choice.message.content ?? undefined,\n      toolCalls:\n        this.settings.useLegacyFunctionCalling && choice.message.function_call\n          ? [\n              {\n                toolCallType: 'function',\n                toolCallId: generateId(),\n                toolName: choice.message.function_call.name,\n                args: choice.message.function_call.arguments,\n              },\n            ]\n          : choice.message.tool_calls?.map(toolCall => ({\n              toolCallType: 'function',\n              toolCallId: toolCall.id ?? generateId(),\n              toolName: toolCall.function.name,\n              args: toolCall.function.arguments!,\n            })),\n      finishReason: mapOpenAIFinishReason(choice.finish_reason),\n      usage: {\n        promptTokens: response.usage?.prompt_tokens ?? NaN,\n        completionTokens: response.usage?.completion_tokens ?? NaN,\n      },\n      rawCall: { rawPrompt, rawSettings },\n      rawResponse: { headers: responseHeaders },\n      request: { body: JSON.stringify(body) },\n      response: getResponseMetadata(response),\n      warnings,\n      logprobs: mapOpenAIChatLogProbsOutput(choice.logprobs),\n      providerMetadata,\n    };\n  }\n\n  async doStream(\n    options: Parameters<LanguageModelV1['doStream']>[0],\n  ): Promise<Awaited<ReturnType<LanguageModelV1['doStream']>>> {\n    const { args, warnings } = this.getArgs(options);\n\n    const body = {\n      ...args,\n      stream: true,\n\n      // only include stream_options when in strict compatibility mode:\n      stream_options:\n        this.config.compatibility === 'strict'\n          ? { include_usage: true }\n          : undefined,\n    };\n\n    const { responseHeaders, value: response } = await postJsonToApi({\n      url: this.config.url({\n        path: '/chat/completions',\n        modelId: this.modelId,\n      }),\n      headers: combineHeaders(this.config.headers(), options.headers),\n      body,\n      failedResponseHandler: openaiFailedResponseHandler,\n      successfulResponseHandler: createEventSourceResponseHandler(\n        openaiChatChunkSchema,\n      ),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch,\n    });\n\n    const { messages: rawPrompt, ...rawSettings } = args;\n\n    const toolCalls: Array<{\n      id: string;\n      type: 'function';\n      function: {\n        name: string;\n        arguments: string;\n      };\n      hasFinished: boolean;\n    }> = [];\n\n    let finishReason: LanguageModelV1FinishReason = 'unknown';\n    let usage: {\n      promptTokens: number | undefined;\n      completionTokens: number | undefined;\n    } = {\n      promptTokens: undefined,\n      completionTokens: undefined,\n    };\n    let logprobs: LanguageModelV1LogProbs;\n    let isFirstChunk = true;\n\n    const { useLegacyFunctionCalling } = this.settings;\n\n    let providerMetadata: LanguageModelV1ProviderMetadata | undefined;\n    return {\n      stream: response.pipeThrough(\n        new TransformStream<\n          ParseResult<z.infer<typeof openaiChatChunkSchema>>,\n          LanguageModelV1StreamPart\n        >({\n          transform(chunk, controller) {\n            // handle failed chunk parsing / validation:\n            if (!chunk.success) {\n              finishReason = 'error';\n              controller.enqueue({ type: 'error', error: chunk.error });\n              return;\n            }\n\n            const value = chunk.value;\n\n            // handle error chunks:\n            if ('error' in value) {\n              finishReason = 'error';\n              controller.enqueue({ type: 'error', error: value.error });\n              return;\n            }\n\n            if (isFirstChunk) {\n              isFirstChunk = false;\n\n              controller.enqueue({\n                type: 'response-metadata',\n                ...getResponseMetadata(value),\n              });\n            }\n\n            if (value.usage != null) {\n              usage = {\n                promptTokens: value.usage.prompt_tokens ?? undefined,\n                completionTokens: value.usage.completion_tokens ?? undefined,\n              };\n\n              const {\n                completion_tokens_details: completionTokenDetails,\n                prompt_tokens_details: promptTokenDetails,\n              } = value.usage;\n\n              if (\n                completionTokenDetails?.reasoning_tokens != null ||\n                promptTokenDetails?.cached_tokens != null\n              ) {\n                providerMetadata = { openai: {} };\n                if (completionTokenDetails?.reasoning_tokens != null) {\n                  providerMetadata.openai.reasoningTokens =\n                    completionTokenDetails?.reasoning_tokens;\n                }\n                if (promptTokenDetails?.cached_tokens != null) {\n                  providerMetadata.openai.cachedPromptTokens =\n                    promptTokenDetails?.cached_tokens;\n                }\n              }\n            }\n\n            const choice = value.choices[0];\n\n            if (choice?.finish_reason != null) {\n              finishReason = mapOpenAIFinishReason(choice.finish_reason);\n            }\n\n            if (choice?.delta == null) {\n              return;\n            }\n\n            const delta = choice.delta;\n\n            if (delta.content != null) {\n              controller.enqueue({\n                type: 'text-delta',\n                textDelta: delta.content,\n              });\n            }\n\n            const mappedLogprobs = mapOpenAIChatLogProbsOutput(\n              choice?.logprobs,\n            );\n            if (mappedLogprobs?.length) {\n              if (logprobs === undefined) logprobs = [];\n              logprobs.push(...mappedLogprobs);\n            }\n\n            const mappedToolCalls: typeof delta.tool_calls =\n              useLegacyFunctionCalling && delta.function_call != null\n                ? [\n                    {\n                      type: 'function',\n                      id: generateId(),\n                      function: delta.function_call,\n                      index: 0,\n                    },\n                  ]\n                : delta.tool_calls;\n\n            if (mappedToolCalls != null) {\n              for (const toolCallDelta of mappedToolCalls) {\n                const index = toolCallDelta.index;\n\n                // Tool call start. OpenAI returns all information except the arguments in the first chunk.\n                if (toolCalls[index] == null) {\n                  if (toolCallDelta.type !== 'function') {\n                    throw new InvalidResponseDataError({\n                      data: toolCallDelta,\n                      message: `Expected 'function' type.`,\n                    });\n                  }\n\n                  if (toolCallDelta.id == null) {\n                    throw new InvalidResponseDataError({\n                      data: toolCallDelta,\n                      message: `Expected 'id' to be a string.`,\n                    });\n                  }\n\n                  if (toolCallDelta.function?.name == null) {\n                    throw new InvalidResponseDataError({\n                      data: toolCallDelta,\n                      message: `Expected 'function.name' to be a string.`,\n                    });\n                  }\n\n                  toolCalls[index] = {\n                    id: toolCallDelta.id,\n                    type: 'function',\n                    function: {\n                      name: toolCallDelta.function.name,\n                      arguments: toolCallDelta.function.arguments ?? '',\n                    },\n                    hasFinished: false,\n                  };\n\n                  const toolCall = toolCalls[index];\n\n                  if (\n                    toolCall.function?.name != null &&\n                    toolCall.function?.arguments != null\n                  ) {\n                    // send delta if the argument text has already started:\n                    if (toolCall.function.arguments.length > 0) {\n                      controller.enqueue({\n                        type: 'tool-call-delta',\n                        toolCallType: 'function',\n                        toolCallId: toolCall.id,\n                        toolName: toolCall.function.name,\n                        argsTextDelta: toolCall.function.arguments,\n                      });\n                    }\n\n                    // check if tool call is complete\n                    // (some providers send the full tool call in one chunk):\n                    if (isParsableJson(toolCall.function.arguments)) {\n                      controller.enqueue({\n                        type: 'tool-call',\n                        toolCallType: 'function',\n                        toolCallId: toolCall.id ?? generateId(),\n                        toolName: toolCall.function.name,\n                        args: toolCall.function.arguments,\n                      });\n                      toolCall.hasFinished = true;\n                    }\n                  }\n\n                  continue;\n                }\n\n                // existing tool call, merge if not finished\n                const toolCall = toolCalls[index];\n\n                if (toolCall.hasFinished) {\n                  continue;\n                }\n\n                if (toolCallDelta.function?.arguments != null) {\n                  toolCall.function!.arguments +=\n                    toolCallDelta.function?.arguments ?? '';\n                }\n\n                // send delta\n                controller.enqueue({\n                  type: 'tool-call-delta',\n                  toolCallType: 'function',\n                  toolCallId: toolCall.id,\n                  toolName: toolCall.function.name,\n                  argsTextDelta: toolCallDelta.function.arguments ?? '',\n                });\n\n                // check if tool call is complete\n                if (\n                  toolCall.function?.name != null &&\n                  toolCall.function?.arguments != null &&\n                  isParsableJson(toolCall.function.arguments)\n                ) {\n                  controller.enqueue({\n                    type: 'tool-call',\n                    toolCallType: 'function',\n                    toolCallId: toolCall.id ?? generateId(),\n                    toolName: toolCall.function.name,\n                    args: toolCall.function.arguments,\n                  });\n                  toolCall.hasFinished = true;\n                }\n              }\n            }\n          },\n\n          flush(controller) {\n            controller.enqueue({\n              type: 'finish',\n              finishReason,\n              logprobs,\n              usage: {\n                promptTokens: usage.promptTokens ?? NaN,\n                completionTokens: usage.completionTokens ?? NaN,\n              },\n              ...(providerMetadata != null ? { providerMetadata } : {}),\n            });\n          },\n        }),\n      ),\n      rawCall: { rawPrompt, rawSettings },\n      rawResponse: { headers: responseHeaders },\n      request: { body: JSON.stringify(body) },\n      warnings,\n    };\n  }\n}\n\nconst openaiTokenUsageSchema = z\n  .object({\n    prompt_tokens: z.number().nullish(),\n    completion_tokens: z.number().nullish(),\n    prompt_tokens_details: z\n      .object({\n        cached_tokens: z.number().nullish(),\n      })\n      .nullish(),\n    completion_tokens_details: z\n      .object({\n        reasoning_tokens: z.number().nullish(),\n      })\n      .nullish(),\n  })\n  .nullish();\n\n// limited version of the schema, focussed on what is needed for the implementation\n// this approach limits breakages when the API changes and increases efficiency\nconst openaiChatResponseSchema = z.object({\n  id: z.string().nullish(),\n  created: z.number().nullish(),\n  model: z.string().nullish(),\n  choices: z.array(\n    z.object({\n      message: z.object({\n        role: z.literal('assistant').nullish(),\n        content: z.string().nullish(),\n        function_call: z\n          .object({\n            arguments: z.string(),\n            name: z.string(),\n          })\n          .nullish(),\n        tool_calls: z\n          .array(\n            z.object({\n              id: z.string().nullish(),\n              type: z.literal('function'),\n              function: z.object({\n                name: z.string(),\n                arguments: z.string(),\n              }),\n            }),\n          )\n          .nullish(),\n      }),\n      index: z.number(),\n      logprobs: z\n        .object({\n          content: z\n            .array(\n              z.object({\n                token: z.string(),\n                logprob: z.number(),\n                top_logprobs: z.array(\n                  z.object({\n                    token: z.string(),\n                    logprob: z.number(),\n                  }),\n                ),\n              }),\n            )\n            .nullable(),\n        })\n        .nullish(),\n      finish_reason: z.string().nullish(),\n    }),\n  ),\n  usage: openaiTokenUsageSchema,\n});\n\n// limited version of the schema, focussed on what is needed for the implementation\n// this approach limits breakages when the API changes and increases efficiency\nconst openaiChatChunkSchema = z.union([\n  z.object({\n    id: z.string().nullish(),\n    created: z.number().nullish(),\n    model: z.string().nullish(),\n    choices: z.array(\n      z.object({\n        delta: z\n          .object({\n            role: z.enum(['assistant']).nullish(),\n            content: z.string().nullish(),\n            function_call: z\n              .object({\n                name: z.string().optional(),\n                arguments: z.string().optional(),\n              })\n              .nullish(),\n            tool_calls: z\n              .array(\n                z.object({\n                  index: z.number(),\n                  id: z.string().nullish(),\n                  type: z.literal('function').optional(),\n                  function: z.object({\n                    name: z.string().nullish(),\n                    arguments: z.string().nullish(),\n                  }),\n                }),\n              )\n              .nullish(),\n          })\n          .nullish(),\n        logprobs: z\n          .object({\n            content: z\n              .array(\n                z.object({\n                  token: z.string(),\n                  logprob: z.number(),\n                  top_logprobs: z.array(\n                    z.object({\n                      token: z.string(),\n                      logprob: z.number(),\n                    }),\n                  ),\n                }),\n              )\n              .nullable(),\n          })\n          .nullish(),\n        finish_reason: z.string().nullable().optional(),\n        index: z.number(),\n      }),\n    ),\n    usage: openaiTokenUsageSchema,\n  }),\n  openaiErrorDataSchema,\n]);\n\nfunction isReasoningModel(modelId: string) {\n  return modelId.startsWith('o1-');\n}\n\nfunction isAudioModel(modelId: string) {\n  return modelId.startsWith('gpt-4o-audio-preview');\n}\n","import {\n  LanguageModelV1Prompt,\n  UnsupportedFunctionalityError,\n} from '@ai-sdk/provider';\nimport { convertUint8ArrayToBase64 } from '@ai-sdk/provider-utils';\nimport { OpenAIChatPrompt } from './openai-chat-prompt';\n\nexport function convertToOpenAIChatMessages({\n  prompt,\n  useLegacyFunctionCalling = false,\n}: {\n  prompt: LanguageModelV1Prompt;\n  useLegacyFunctionCalling?: boolean;\n}): OpenAIChatPrompt {\n  const messages: OpenAIChatPrompt = [];\n\n  for (const { role, content } of prompt) {\n    switch (role) {\n      case 'system': {\n        messages.push({ role: 'system', content });\n        break;\n      }\n\n      case 'user': {\n        if (content.length === 1 && content[0].type === 'text') {\n          messages.push({ role: 'user', content: content[0].text });\n          break;\n        }\n\n        messages.push({\n          role: 'user',\n          content: content.map(part => {\n            switch (part.type) {\n              case 'text': {\n                return { type: 'text', text: part.text };\n              }\n              case 'image': {\n                return {\n                  type: 'image_url',\n                  image_url: {\n                    url:\n                      part.image instanceof URL\n                        ? part.image.toString()\n                        : `data:${\n                            part.mimeType ?? 'image/jpeg'\n                          };base64,${convertUint8ArrayToBase64(part.image)}`,\n\n                    // OpenAI specific extension: image detail\n                    detail: part.providerMetadata?.openai?.imageDetail,\n                  },\n                };\n              }\n              case 'file': {\n                if (part.data instanceof URL) {\n                  throw new UnsupportedFunctionalityError({\n                    functionality:\n                      \"'File content parts with URL data' functionality not supported.\",\n                  });\n                }\n\n                switch (part.mimeType) {\n                  case 'audio/wav': {\n                    return {\n                      type: 'input_audio',\n                      input_audio: { data: part.data, format: 'wav' },\n                    };\n                  }\n                  case 'audio/mp3':\n                  case 'audio/mpeg': {\n                    return {\n                      type: 'input_audio',\n                      input_audio: { data: part.data, format: 'mp3' },\n                    };\n                  }\n\n                  default: {\n                    throw new UnsupportedFunctionalityError({\n                      functionality: `File content part type ${part.mimeType} in user messages`,\n                    });\n                  }\n                }\n              }\n            }\n          }),\n        });\n\n        break;\n      }\n\n      case 'assistant': {\n        let text = '';\n        const toolCalls: Array<{\n          id: string;\n          type: 'function';\n          function: { name: string; arguments: string };\n        }> = [];\n\n        for (const part of content) {\n          switch (part.type) {\n            case 'text': {\n              text += part.text;\n              break;\n            }\n            case 'tool-call': {\n              toolCalls.push({\n                id: part.toolCallId,\n                type: 'function',\n                function: {\n                  name: part.toolName,\n                  arguments: JSON.stringify(part.args),\n                },\n              });\n              break;\n            }\n            default: {\n              const _exhaustiveCheck: never = part;\n              throw new Error(`Unsupported part: ${_exhaustiveCheck}`);\n            }\n          }\n        }\n\n        if (useLegacyFunctionCalling) {\n          if (toolCalls.length > 1) {\n            throw new UnsupportedFunctionalityError({\n              functionality:\n                'useLegacyFunctionCalling with multiple tool calls in one message',\n            });\n          }\n\n          messages.push({\n            role: 'assistant',\n            content: text,\n            function_call:\n              toolCalls.length > 0 ? toolCalls[0].function : undefined,\n          });\n        } else {\n          messages.push({\n            role: 'assistant',\n            content: text,\n            tool_calls: toolCalls.length > 0 ? toolCalls : undefined,\n          });\n        }\n\n        break;\n      }\n\n      case 'tool': {\n        for (const toolResponse of content) {\n          if (useLegacyFunctionCalling) {\n            messages.push({\n              role: 'function',\n              name: toolResponse.toolName,\n              content: JSON.stringify(toolResponse.result),\n            });\n          } else {\n            messages.push({\n              role: 'tool',\n              tool_call_id: toolResponse.toolCallId,\n              content: JSON.stringify(toolResponse.result),\n            });\n          }\n        }\n        break;\n      }\n\n      default: {\n        const _exhaustiveCheck: never = role;\n        throw new Error(`Unsupported role: ${_exhaustiveCheck}`);\n      }\n    }\n  }\n\n  return messages;\n}\n","import { LanguageModelV1LogProbs } from '@ai-sdk/provider';\n\ntype OpenAIChatLogProbs = {\n  content:\n    | {\n        token: string;\n        logprob: number;\n        top_logprobs:\n          | {\n              token: string;\n              logprob: number;\n            }[]\n          | null;\n      }[]\n    | null;\n};\n\nexport function mapOpenAIChatLogProbsOutput(\n  logprobs: OpenAIChatLogProbs | null | undefined,\n): LanguageModelV1LogProbs | undefined {\n  return (\n    logprobs?.content?.map(({ token, logprob, top_logprobs }) => ({\n      token,\n      logprob,\n      topLogprobs: top_logprobs\n        ? top_logprobs.map(({ token, logprob }) => ({\n            token,\n            logprob,\n          }))\n        : [],\n    })) ?? undefined\n  );\n}\n","import { LanguageModelV1FinishReason } from '@ai-sdk/provider';\n\nexport function mapOpenAIFinishReason(\n  finishReason: string | null | undefined,\n): LanguageModelV1FinishReason {\n  switch (finishReason) {\n    case 'stop':\n      return 'stop';\n    case 'length':\n      return 'length';\n    case 'content_filter':\n      return 'content-filter';\n    case 'function_call':\n    case 'tool_calls':\n      return 'tool-calls';\n    default:\n      return 'unknown';\n  }\n}\n","import { z } from 'zod';\nimport { createJsonErrorResponseHandler } from '@ai-sdk/provider-utils';\n\nexport const openaiErrorDataSchema = z.object({\n  error: z.object({\n    message: z.string(),\n\n    // The additional information below is handled loosely to support\n    // OpenAI-compatible providers that have slightly different error\n    // responses:\n    type: z.string().nullish(),\n    param: z.any().nullish(),\n    code: z.union([z.string(), z.number()]).nullish(),\n  }),\n});\n\nexport type OpenAIErrorData = z.infer<typeof openaiErrorDataSchema>;\n\nexport const openaiFailedResponseHandler = createJsonErrorResponseHandler({\n  errorSchema: openaiErrorDataSchema,\n  errorToMessage: data => data.error.message,\n});\n","export function getResponseMetadata({\n  id,\n  model,\n  created,\n}: {\n  id?: string | undefined | null;\n  created?: number | undefined | null;\n  model?: string | undefined | null;\n}) {\n  return {\n    id: id ?? undefined,\n    modelId: model ?? undefined,\n    timestamp: created != null ? new Date(created * 1000) : undefined,\n  };\n}\n","import {\n  JSONSchema7,\n  LanguageModelV1,\n  LanguageModelV1CallWarning,\n  UnsupportedFunctionalityError,\n} from '@ai-sdk/provider';\n\nexport function prepareTools({\n  mode,\n  useLegacyFunctionCalling = false,\n  structuredOutputs,\n}: {\n  mode: Parameters<LanguageModelV1['doGenerate']>[0]['mode'] & {\n    type: 'regular';\n  };\n  useLegacyFunctionCalling: boolean | undefined;\n  structuredOutputs: boolean;\n}): {\n  tools?: {\n    type: 'function';\n    function: {\n      name: string;\n      description: string | undefined;\n      parameters: JSONSchema7;\n      strict?: boolean;\n    };\n  }[];\n  tool_choice?:\n    | 'auto'\n    | 'none'\n    | 'required'\n    | { type: 'function'; function: { name: string } };\n\n  // legacy support\n  functions?: {\n    name: string;\n    description: string | undefined;\n    parameters: JSONSchema7;\n  }[];\n  function_call?: { name: string };\n\n  toolWarnings: LanguageModelV1CallWarning[];\n} {\n  // when the tools array is empty, change it to undefined to prevent errors:\n  const tools = mode.tools?.length ? mode.tools : undefined;\n\n  const toolWarnings: LanguageModelV1CallWarning[] = [];\n\n  if (tools == null) {\n    return { tools: undefined, tool_choice: undefined, toolWarnings };\n  }\n\n  const toolChoice = mode.toolChoice;\n\n  if (useLegacyFunctionCalling) {\n    const openaiFunctions: Array<{\n      name: string;\n      description: string | undefined;\n      parameters: JSONSchema7;\n    }> = [];\n\n    for (const tool of tools) {\n      if (tool.type === 'provider-defined') {\n        toolWarnings.push({ type: 'unsupported-tool', tool });\n      } else {\n        openaiFunctions.push({\n          name: tool.name,\n          description: tool.description,\n          parameters: tool.parameters,\n        });\n      }\n    }\n\n    if (toolChoice == null) {\n      return {\n        functions: openaiFunctions,\n        function_call: undefined,\n        toolWarnings,\n      };\n    }\n\n    const type = toolChoice.type;\n\n    switch (type) {\n      case 'auto':\n      case 'none':\n      case undefined:\n        return {\n          functions: openaiFunctions,\n          function_call: undefined,\n          toolWarnings,\n        };\n      case 'required':\n        throw new UnsupportedFunctionalityError({\n          functionality: 'useLegacyFunctionCalling and toolChoice: required',\n        });\n      default:\n        return {\n          functions: openaiFunctions,\n          function_call: { name: toolChoice.toolName },\n          toolWarnings,\n        };\n    }\n  }\n\n  const openaiTools: Array<{\n    type: 'function';\n    function: {\n      name: string;\n      description: string | undefined;\n      parameters: JSONSchema7;\n      strict: boolean | undefined;\n    };\n  }> = [];\n\n  for (const tool of tools) {\n    if (tool.type === 'provider-defined') {\n      toolWarnings.push({ type: 'unsupported-tool', tool });\n    } else {\n      openaiTools.push({\n        type: 'function',\n        function: {\n          name: tool.name,\n          description: tool.description,\n          parameters: tool.parameters,\n          strict: structuredOutputs ? true : undefined,\n        },\n      });\n    }\n  }\n\n  if (toolChoice == null) {\n    return { tools: openaiTools, tool_choice: undefined, toolWarnings };\n  }\n\n  const type = toolChoice.type;\n\n  switch (type) {\n    case 'auto':\n    case 'none':\n    case 'required':\n      return { tools: openaiTools, tool_choice: type, toolWarnings };\n    case 'tool':\n      return {\n        tools: openaiTools,\n        tool_choice: {\n          type: 'function',\n          function: {\n            name: toolChoice.toolName,\n          },\n        },\n        toolWarnings,\n      };\n    default: {\n      const _exhaustiveCheck: never = type;\n      throw new UnsupportedFunctionalityError({\n        functionality: `Unsupported tool choice type: ${_exhaustiveCheck}`,\n      });\n    }\n  }\n}\n","import {\n  LanguageModelV1,\n  LanguageModelV1CallWarning,\n  LanguageModelV1FinishReason,\n  LanguageModelV1LogProbs,\n  LanguageModelV1StreamPart,\n  UnsupportedFunctionalityError,\n} from '@ai-sdk/provider';\nimport {\n  FetchFunction,\n  ParseResult,\n  combineHeaders,\n  createEventSourceResponseHandler,\n  createJsonResponseHandler,\n  postJsonToApi,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod';\nimport { convertToOpenAICompletionPrompt } from './convert-to-openai-completion-prompt';\nimport { mapOpenAICompletionLogProbs } from './map-openai-completion-logprobs';\nimport { mapOpenAIFinishReason } from './map-openai-finish-reason';\nimport {\n  OpenAICompletionModelId,\n  OpenAICompletionSettings,\n} from './openai-completion-settings';\nimport {\n  openaiErrorDataSchema,\n  openaiFailedResponseHandler,\n} from './openai-error';\nimport { getResponseMetadata } from './get-response-metadata';\n\ntype OpenAICompletionConfig = {\n  provider: string;\n  compatibility: 'strict' | 'compatible';\n  headers: () => Record<string, string | undefined>;\n  url: (options: { modelId: string; path: string }) => string;\n  fetch?: FetchFunction;\n};\n\nexport class OpenAICompletionLanguageModel implements LanguageModelV1 {\n  readonly specificationVersion = 'v1';\n  readonly defaultObjectGenerationMode = undefined;\n\n  readonly modelId: OpenAICompletionModelId;\n  readonly settings: OpenAICompletionSettings;\n\n  private readonly config: OpenAICompletionConfig;\n\n  constructor(\n    modelId: OpenAICompletionModelId,\n    settings: OpenAICompletionSettings,\n    config: OpenAICompletionConfig,\n  ) {\n    this.modelId = modelId;\n    this.settings = settings;\n    this.config = config;\n  }\n\n  get provider(): string {\n    return this.config.provider;\n  }\n\n  private getArgs({\n    mode,\n    inputFormat,\n    prompt,\n    maxTokens,\n    temperature,\n    topP,\n    topK,\n    frequencyPenalty,\n    presencePenalty,\n    stopSequences: userStopSequences,\n    responseFormat,\n    seed,\n  }: Parameters<LanguageModelV1['doGenerate']>[0]) {\n    const type = mode.type;\n\n    const warnings: LanguageModelV1CallWarning[] = [];\n\n    if (topK != null) {\n      warnings.push({\n        type: 'unsupported-setting',\n        setting: 'topK',\n      });\n    }\n\n    if (responseFormat != null && responseFormat.type !== 'text') {\n      warnings.push({\n        type: 'unsupported-setting',\n        setting: 'responseFormat',\n        details: 'JSON response format is not supported.',\n      });\n    }\n\n    const { prompt: completionPrompt, stopSequences } =\n      convertToOpenAICompletionPrompt({ prompt, inputFormat });\n\n    const stop = [...(stopSequences ?? []), ...(userStopSequences ?? [])];\n\n    const baseArgs = {\n      // model id:\n      model: this.modelId,\n\n      // model specific settings:\n      echo: this.settings.echo,\n      logit_bias: this.settings.logitBias,\n      logprobs:\n        typeof this.settings.logprobs === 'number'\n          ? this.settings.logprobs\n          : typeof this.settings.logprobs === 'boolean'\n          ? this.settings.logprobs\n            ? 0\n            : undefined\n          : undefined,\n      suffix: this.settings.suffix,\n      user: this.settings.user,\n\n      // standardized settings:\n      max_tokens: maxTokens,\n      temperature,\n      top_p: topP,\n      frequency_penalty: frequencyPenalty,\n      presence_penalty: presencePenalty,\n      seed,\n\n      // prompt:\n      prompt: completionPrompt,\n\n      // stop sequences:\n      stop: stop.length > 0 ? stop : undefined,\n    };\n\n    switch (type) {\n      case 'regular': {\n        if (mode.tools?.length) {\n          throw new UnsupportedFunctionalityError({\n            functionality: 'tools',\n          });\n        }\n\n        if (mode.toolChoice) {\n          throw new UnsupportedFunctionalityError({\n            functionality: 'toolChoice',\n          });\n        }\n\n        return { args: baseArgs, warnings };\n      }\n\n      case 'object-json': {\n        throw new UnsupportedFunctionalityError({\n          functionality: 'object-json mode',\n        });\n      }\n\n      case 'object-tool': {\n        throw new UnsupportedFunctionalityError({\n          functionality: 'object-tool mode',\n        });\n      }\n\n      default: {\n        const _exhaustiveCheck: never = type;\n        throw new Error(`Unsupported type: ${_exhaustiveCheck}`);\n      }\n    }\n  }\n\n  async doGenerate(\n    options: Parameters<LanguageModelV1['doGenerate']>[0],\n  ): Promise<Awaited<ReturnType<LanguageModelV1['doGenerate']>>> {\n    const { args, warnings } = this.getArgs(options);\n\n    const { responseHeaders, value: response } = await postJsonToApi({\n      url: this.config.url({\n        path: '/completions',\n        modelId: this.modelId,\n      }),\n      headers: combineHeaders(this.config.headers(), options.headers),\n      body: args,\n      failedResponseHandler: openaiFailedResponseHandler,\n      successfulResponseHandler: createJsonResponseHandler(\n        openaiCompletionResponseSchema,\n      ),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch,\n    });\n\n    const { prompt: rawPrompt, ...rawSettings } = args;\n    const choice = response.choices[0];\n\n    return {\n      text: choice.text,\n      usage: {\n        promptTokens: response.usage.prompt_tokens,\n        completionTokens: response.usage.completion_tokens,\n      },\n      finishReason: mapOpenAIFinishReason(choice.finish_reason),\n      logprobs: mapOpenAICompletionLogProbs(choice.logprobs),\n      rawCall: { rawPrompt, rawSettings },\n      rawResponse: { headers: responseHeaders },\n      response: getResponseMetadata(response),\n      warnings,\n      request: { body: JSON.stringify(args) },\n    };\n  }\n\n  async doStream(\n    options: Parameters<LanguageModelV1['doStream']>[0],\n  ): Promise<Awaited<ReturnType<LanguageModelV1['doStream']>>> {\n    const { args, warnings } = this.getArgs(options);\n\n    const body = {\n      ...args,\n      stream: true,\n\n      // only include stream_options when in strict compatibility mode:\n      stream_options:\n        this.config.compatibility === 'strict'\n          ? { include_usage: true }\n          : undefined,\n    };\n\n    const { responseHeaders, value: response } = await postJsonToApi({\n      url: this.config.url({\n        path: '/completions',\n        modelId: this.modelId,\n      }),\n      headers: combineHeaders(this.config.headers(), options.headers),\n      body,\n      failedResponseHandler: openaiFailedResponseHandler,\n      successfulResponseHandler: createEventSourceResponseHandler(\n        openaiCompletionChunkSchema,\n      ),\n      abortSignal: options.abortSignal,\n      fetch: this.config.fetch,\n    });\n\n    const { prompt: rawPrompt, ...rawSettings } = args;\n\n    let finishReason: LanguageModelV1FinishReason = 'unknown';\n    let usage: { promptTokens: number; completionTokens: number } = {\n      promptTokens: Number.NaN,\n      completionTokens: Number.NaN,\n    };\n    let logprobs: LanguageModelV1LogProbs;\n    let isFirstChunk = true;\n\n    return {\n      stream: response.pipeThrough(\n        new TransformStream<\n          ParseResult<z.infer<typeof openaiCompletionChunkSchema>>,\n          LanguageModelV1StreamPart\n        >({\n          transform(chunk, controller) {\n            // handle failed chunk parsing / validation:\n            if (!chunk.success) {\n              finishReason = 'error';\n              controller.enqueue({ type: 'error', error: chunk.error });\n              return;\n            }\n\n            const value = chunk.value;\n\n            // handle error chunks:\n            if ('error' in value) {\n              finishReason = 'error';\n              controller.enqueue({ type: 'error', error: value.error });\n              return;\n            }\n\n            if (isFirstChunk) {\n              isFirstChunk = false;\n\n              controller.enqueue({\n                type: 'response-metadata',\n                ...getResponseMetadata(value),\n              });\n            }\n\n            if (value.usage != null) {\n              usage = {\n                promptTokens: value.usage.prompt_tokens,\n                completionTokens: value.usage.completion_tokens,\n              };\n            }\n\n            const choice = value.choices[0];\n\n            if (choice?.finish_reason != null) {\n              finishReason = mapOpenAIFinishReason(choice.finish_reason);\n            }\n\n            if (choice?.text != null) {\n              controller.enqueue({\n                type: 'text-delta',\n                textDelta: choice.text,\n              });\n            }\n\n            const mappedLogprobs = mapOpenAICompletionLogProbs(\n              choice?.logprobs,\n            );\n            if (mappedLogprobs?.length) {\n              if (logprobs === undefined) logprobs = [];\n              logprobs.push(...mappedLogprobs);\n            }\n          },\n\n          flush(controller) {\n            controller.enqueue({\n              type: 'finish',\n              finishReason,\n              logprobs,\n              usage,\n            });\n          },\n        }),\n      ),\n      rawCall: { rawPrompt, rawSettings },\n      rawResponse: { headers: responseHeaders },\n      warnings,\n      request: { body: JSON.stringify(body) },\n    };\n  }\n}\n\n// limited version of the schema, focussed on what is needed for the implementation\n// this approach limits breakages when the API changes and increases efficiency\nconst openaiCompletionResponseSchema = z.object({\n  id: z.string().nullish(),\n  created: z.number().nullish(),\n  model: z.string().nullish(),\n  choices: z.array(\n    z.object({\n      text: z.string(),\n      finish_reason: z.string(),\n      logprobs: z\n        .object({\n          tokens: z.array(z.string()),\n          token_logprobs: z.array(z.number()),\n          top_logprobs: z.array(z.record(z.string(), z.number())).nullable(),\n        })\n        .nullish(),\n    }),\n  ),\n  usage: z.object({\n    prompt_tokens: z.number(),\n    completion_tokens: z.number(),\n  }),\n});\n\n// limited version of the schema, focussed on what is needed for the implementation\n// this approach limits breakages when the API changes and increases efficiency\nconst openaiCompletionChunkSchema = z.union([\n  z.object({\n    id: z.string().nullish(),\n    created: z.number().nullish(),\n    model: z.string().nullish(),\n    choices: z.array(\n      z.object({\n        text: z.string(),\n        finish_reason: z.string().nullish(),\n        index: z.number(),\n        logprobs: z\n          .object({\n            tokens: z.array(z.string()),\n            token_logprobs: z.array(z.number()),\n            top_logprobs: z.array(z.record(z.string(), z.number())).nullable(),\n          })\n          .nullish(),\n      }),\n    ),\n    usage: z\n      .object({\n        prompt_tokens: z.number(),\n        completion_tokens: z.number(),\n      })\n      .nullish(),\n  }),\n  openaiErrorDataSchema,\n]);\n","import {\n  InvalidPromptError,\n  LanguageModelV1Prompt,\n  UnsupportedFunctionalityError,\n} from '@ai-sdk/provider';\n\nexport function convertToOpenAICompletionPrompt({\n  prompt,\n  inputFormat,\n  user = 'user',\n  assistant = 'assistant',\n}: {\n  prompt: LanguageModelV1Prompt;\n  inputFormat: 'prompt' | 'messages';\n  user?: string;\n  assistant?: string;\n}): {\n  prompt: string;\n  stopSequences?: string[];\n} {\n  // When the user supplied a prompt input, we don't transform it:\n  if (\n    inputFormat === 'prompt' &&\n    prompt.length === 1 &&\n    prompt[0].role === 'user' &&\n    prompt[0].content.length === 1 &&\n    prompt[0].content[0].type === 'text'\n  ) {\n    return { prompt: prompt[0].content[0].text };\n  }\n\n  // otherwise transform to a chat message format:\n  let text = '';\n\n  // if first message is a system message, add it to the text:\n  if (prompt[0].role === 'system') {\n    text += `${prompt[0].content}\\n\\n`;\n    prompt = prompt.slice(1);\n  }\n\n  for (const { role, content } of prompt) {\n    switch (role) {\n      case 'system': {\n        throw new InvalidPromptError({\n          message: 'Unexpected system message in prompt: ${content}',\n          prompt,\n        });\n      }\n\n      case 'user': {\n        const userMessage = content\n          .map(part => {\n            switch (part.type) {\n              case 'text': {\n                return part.text;\n              }\n              case 'image': {\n                throw new UnsupportedFunctionalityError({\n                  functionality: 'images',\n                });\n              }\n            }\n          })\n          .join('');\n\n        text += `${user}:\\n${userMessage}\\n\\n`;\n        break;\n      }\n\n      case 'assistant': {\n        const assistantMessage = content\n          .map(part => {\n            switch (part.type) {\n              case 'text': {\n                return part.text;\n              }\n              case 'tool-call': {\n                throw new UnsupportedFunctionalityError({\n                  functionality: 'tool-call messages',\n                });\n              }\n            }\n          })\n          .join('');\n\n        text += `${assistant}:\\n${assistantMessage}\\n\\n`;\n        break;\n      }\n\n      case 'tool': {\n        throw new UnsupportedFunctionalityError({\n          functionality: 'tool messages',\n        });\n      }\n\n      default: {\n        const _exhaustiveCheck: never = role;\n        throw new Error(`Unsupported role: ${_exhaustiveCheck}`);\n      }\n    }\n  }\n\n  // Assistant message prefix:\n  text += `${assistant}:\\n`;\n\n  return {\n    prompt: text,\n    stopSequences: [`\\n${user}:`],\n  };\n}\n","import { LanguageModelV1LogProbs } from '@ai-sdk/provider';\n\ntype OpenAICompletionLogProps = {\n  tokens: string[];\n  token_logprobs: number[];\n  top_logprobs: Record<string, number>[] | null;\n};\n\nexport function mapOpenAICompletionLogProbs(\n  logprobs: OpenAICompletionLogProps | null | undefined,\n): LanguageModelV1LogProbs | undefined {\n  return logprobs?.tokens.map((token, index) => ({\n    token,\n    logprob: logprobs.token_logprobs[index],\n    topLogprobs: logprobs.top_logprobs\n      ? Object.entries(logprobs.top_logprobs[index]).map(\n          ([token, logprob]) => ({\n            token,\n            logprob,\n          }),\n        )\n      : [],\n  }));\n}\n","import {\n  EmbeddingModelV1,\n  TooManyEmbeddingValuesForCallError,\n} from '@ai-sdk/provider';\nimport {\n  combineHeaders,\n  createJsonResponseHandler,\n  FetchFunction,\n  postJsonToApi,\n} from '@ai-sdk/provider-utils';\nimport { z } from 'zod';\nimport {\n  OpenAIEmbeddingModelId,\n  OpenAIEmbeddingSettings,\n} from './openai-embedding-settings';\nimport { openaiFailedResponseHandler } from './openai-error';\n\ntype OpenAIEmbeddingConfig = {\n  provider: string;\n  url: (options: { modelId: string; path: string }) => string;\n  headers: () => Record<string, string | undefined>;\n  fetch?: FetchFunction;\n};\n\nexport class OpenAIEmbeddingModel implements EmbeddingModelV1<string> {\n  readonly specificationVersion = 'v1';\n  readonly modelId: OpenAIEmbeddingModelId;\n\n  private readonly config: OpenAIEmbeddingConfig;\n  private readonly settings: OpenAIEmbeddingSettings;\n\n  get provider(): string {\n    return this.config.provider;\n  }\n\n  get maxEmbeddingsPerCall(): number {\n    return this.settings.maxEmbeddingsPerCall ?? 2048;\n  }\n\n  get supportsParallelCalls(): boolean {\n    return this.settings.supportsParallelCalls ?? true;\n  }\n\n  constructor(\n    modelId: OpenAIEmbeddingModelId,\n    settings: OpenAIEmbeddingSettings,\n    config: OpenAIEmbeddingConfig,\n  ) {\n    this.modelId = modelId;\n    this.settings = settings;\n    this.config = config;\n  }\n\n  async doEmbed({\n    values,\n    headers,\n    abortSignal,\n  }: Parameters<EmbeddingModelV1<string>['doEmbed']>[0]): Promise<\n    Awaited<ReturnType<EmbeddingModelV1<string>['doEmbed']>>\n  > {\n    if (values.length > this.maxEmbeddingsPerCall) {\n      throw new TooManyEmbeddingValuesForCallError({\n        provider: this.provider,\n        modelId: this.modelId,\n        maxEmbeddingsPerCall: this.maxEmbeddingsPerCall,\n        values,\n      });\n    }\n\n    const { responseHeaders, value: response } = await postJsonToApi({\n      url: this.config.url({\n        path: '/embeddings',\n        modelId: this.modelId,\n      }),\n      headers: combineHeaders(this.config.headers(), headers),\n      body: {\n        model: this.modelId,\n        input: values,\n        encoding_format: 'float',\n        dimensions: this.settings.dimensions,\n        user: this.settings.user,\n      },\n      failedResponseHandler: openaiFailedResponseHandler,\n      successfulResponseHandler: createJsonResponseHandler(\n        openaiTextEmbeddingResponseSchema,\n      ),\n      abortSignal,\n      fetch: this.config.fetch,\n    });\n\n    return {\n      embeddings: response.data.map(item => item.embedding),\n      usage: response.usage\n        ? { tokens: response.usage.prompt_tokens }\n        : undefined,\n      rawResponse: { headers: responseHeaders },\n    };\n  }\n}\n\n// minimal version of the schema, focussed on what is needed for the implementation\n// this approach limits breakages when the API changes and increases efficiency\nconst openaiTextEmbeddingResponseSchema = z.object({\n  data: z.array(z.object({ embedding: z.array(z.number()) })),\n  usage: z.object({ prompt_tokens: z.number() }).nullish(),\n});\n"],"names":["UnsupportedFunctionalityError","z","token","logprob","UnsupportedFunctionalityError","type","UnsupportedFunctionalityError","_a","toolCall","z","UnsupportedFunctionalityError","combineHeaders","createEventSourceResponseHandler","createJsonResponseHandler","postJsonToApi","z","UnsupportedFunctionalityError","token","UnsupportedFunctionalityError","postJsonToApi","combineHeaders","createJsonResponseHandler","createEventSourceResponseHandler","z","combineHeaders","createJsonResponseHandler","postJsonToApi","z","postJsonToApi","combineHeaders","createJsonResponseHandler","z"],"mappings":";;;;;;;AOAA;AAQA;AAQA,SAAS,KAAAe,UAAS;;;;;;ANTX,SAAS,4BAA4B,EAC1C,MAAA,EACA,2BAA2B,KAAA,EAC7B,EAGqB;IACnB,MAAM,WAA6B,CAAC,CAAA;IAEpC,KAAA,MAAW,EAAE,IAAA,EAAM,OAAA,CAAQ,CAAA,IAAK,OAAQ;QACtC,OAAQ,MAAM;YACZ,KAAK;gBAAU;oBACb,SAAS,IAAA,CAAK;wBAAE,MAAM;wBAAU;oBAAQ,CAAC;oBACzC;gBACF;YAEA,KAAK;gBAAQ;oBACX,IAAI,QAAQ,MAAA,KAAW,KAAK,OAAA,CAAQ,CAAC,CAAA,CAAE,IAAA,KAAS,QAAQ;wBACtD,SAAS,IAAA,CAAK;4BAAE,MAAM;4BAAQ,SAAS,OAAA,CAAQ,CAAC,CAAA,CAAE,IAAA;wBAAK,CAAC;wBACxD;oBACF;oBAEA,SAAS,IAAA,CAAK;wBACZ,MAAM;wBACN,SAAS,QAAQ,GAAA,CAAI,CAAA,SAAQ;4BA/BvC,IAAA,IAAA,IAAA;4BAgCY,OAAQ,KAAK,IAAA,EAAM;gCACjB,KAAK;oCAAQ;wCACX,OAAO;4CAAE,MAAM;4CAAQ,MAAM,KAAK,IAAA;wCAAK;oCACzC;gCACA,KAAK;oCAAS;wCACZ,OAAO;4CACL,MAAM;4CACN,WAAW;gDACT,KACE,KAAK,KAAA,YAAiB,MAClB,KAAK,KAAA,CAAM,QAAA,CAAS,IACpB,CAAA,KAAA,EAAA,CACE,KAAA,KAAK,QAAA,KAAL,OAAA,KAAiB,YACnB,CAAA,QAAA,0QAAW,4BAAA,EAA0B,KAAK,KAAK,CAAC,EAAA;gDAAA,0CAAA;gDAGtD,QAAA,CAAQ,KAAA,CAAA,KAAA,KAAK,gBAAA,KAAL,OAAA,KAAA,IAAA,GAAuB,MAAA,KAAvB,OAAA,KAAA,IAAA,GAA+B,WAAA;4CACzC;wCACF;oCACF;gCACA,KAAK;oCAAQ;wCACX,IAAI,KAAK,IAAA,YAAgB,KAAK;4CAC5B,MAAM,kOAAI,gCAAA,CAA8B;gDACtC,eACE;4CACJ,CAAC;wCACH;wCAEA,OAAQ,KAAK,QAAA,EAAU;4CACrB,KAAK;gDAAa;oDAChB,OAAO;wDACL,MAAM;wDACN,aAAa;4DAAE,MAAM,KAAK,IAAA;4DAAM,QAAQ;wDAAM;oDAChD;gDACF;4CACA,KAAK;4CACL,KAAK;gDAAc;oDACjB,OAAO;wDACL,MAAM;wDACN,aAAa;4DAAE,MAAM,KAAK,IAAA;4DAAM,QAAQ;wDAAM;oDAChD;gDACF;4CAEA;gDAAS;oDACP,MAAM,kOAAI,gCAAA,CAA8B;wDACtC,eAAe,CAAA,uBAAA,EAA0B,KAAK,QAAQ,CAAA,iBAAA,CAAA;oDACxD,CAAC;gDACH;wCACF;oCACF;4BACF;wBACF,CAAC;oBACH,CAAC;oBAED;gBACF;YAEA,KAAK;gBAAa;oBAChB,IAAI,OAAO;oBACX,MAAM,YAID,CAAC,CAAA;oBAEN,KAAA,MAAW,QAAQ,QAAS;wBAC1B,OAAQ,KAAK,IAAA,EAAM;4BACjB,KAAK;gCAAQ;oCACX,QAAQ,KAAK,IAAA;oCACb;gCACF;4BACA,KAAK;gCAAa;oCAChB,UAAU,IAAA,CAAK;wCACb,IAAI,KAAK,UAAA;wCACT,MAAM;wCACN,UAAU;4CACR,MAAM,KAAK,QAAA;4CACX,WAAW,KAAK,SAAA,CAAU,KAAK,IAAI;wCACrC;oCACF,CAAC;oCACD;gCACF;4BACA;gCAAS;oCACP,MAAM,mBAA0B;oCAChC,MAAM,IAAI,MAAM,CAAA,kBAAA,EAAqB,gBAAgB,EAAE;gCACzD;wBACF;oBACF;oBAEA,IAAI,0BAA0B;wBAC5B,IAAI,UAAU,MAAA,GAAS,GAAG;4BACxB,MAAM,kOAAI,gCAAA,CAA8B;gCACtC,eACE;4BACJ,CAAC;wBACH;wBAEA,SAAS,IAAA,CAAK;4BACZ,MAAM;4BACN,SAAS;4BACT,eACE,UAAU,MAAA,GAAS,IAAI,SAAA,CAAU,CAAC,CAAA,CAAE,QAAA,GAAW,KAAA;wBACnD,CAAC;oBACH,OAAO;wBACL,SAAS,IAAA,CAAK;4BACZ,MAAM;4BACN,SAAS;4BACT,YAAY,UAAU,MAAA,GAAS,IAAI,YAAY,KAAA;wBACjD,CAAC;oBACH;oBAEA;gBACF;YAEA,KAAK;gBAAQ;oBACX,KAAA,MAAW,gBAAgB,QAAS;wBAClC,IAAI,0BAA0B;4BAC5B,SAAS,IAAA,CAAK;gCACZ,MAAM;gCACN,MAAM,aAAa,QAAA;gCACnB,SAAS,KAAK,SAAA,CAAU,aAAa,MAAM;4BAC7C,CAAC;wBACH,OAAO;4BACL,SAAS,IAAA,CAAK;gCACZ,MAAM;gCACN,cAAc,aAAa,UAAA;gCAC3B,SAAS,KAAK,SAAA,CAAU,aAAa,MAAM;4BAC7C,CAAC;wBACH;oBACF;oBACA;gBACF;YAEA;gBAAS;oBACP,MAAM,mBAA0B;oBAChC,MAAM,IAAI,MAAM,CAAA,kBAAA,EAAqB,gBAAgB,EAAE;gBACzD;QACF;IACF;IAEA,OAAO;AACT;;AC5JO,SAAS,4BACd,QAAA,EACqC;IAnBvC,IAAA,IAAA;IAoBE,OAAA,CACE,KAAA,CAAA,KAAA,YAAA,OAAA,KAAA,IAAA,SAAU,OAAA,KAAV,OAAA,KAAA,IAAA,GAAmB,GAAA,CAAI,CAAC,EAAE,KAAA,EAAO,OAAA,EAAS,YAAA,CAAa,CAAA,GAAA,CAAO;YAC5D;YACA;YACA,aAAa,eACT,aAAa,GAAA,CAAI,CAAC,EAAE,OAAAb,MAAAA,EAAO,SAAAC,QAAAA,CAAQ,CAAA,GAAA,CAAO;oBACxC,OAAAD;oBACA,SAAAC;gBACF,CAAA,CAAE,IACF,CAAC,CAAA;QACP,CAAA,EAAA,KATA,OAAA,KASO,KAAA;AAEX;;AC9BO,SAAS,sBACd,YAAA,EAC6B;IAC7B,OAAQ,cAAc;QACpB,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;QACL,KAAK;YACH,OAAO;QACT;YACE,OAAO;IACX;AACF;;;ACfO,IAAM,8MAAwB,IAAA,CAAE,MAAA,CAAO;IAC5C,6LAAO,IAAA,CAAE,MAAA,CAAO;QACd,SAAS,0LAAA,CAAE,MAAA,CAAO;QAAA,iEAAA;QAAA,iEAAA;QAAA,aAAA;QAKlB,4LAAM,IAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;QACzB,6LAAO,IAAA,CAAE,GAAA,CAAI,EAAE,OAAA,CAAQ;QACvB,4LAAM,IAAA,CAAE,KAAA,CAAM;kMAAC,IAAA,CAAE,MAAA,CAAO;kMAAG,IAAA,CAAE,MAAA,CAAO,CAAC;SAAC,EAAE,OAAA,CAAQ;IAClD,CAAC;AACH,CAAC;AAIM,IAAM,sSAA8B,iCAAA,EAA+B;IACxE,aAAa;IACb,gBAAgB,CAAA,OAAQ,KAAK,KAAA,CAAM,OAAA;AACrC,CAAC;;ACrBM,SAAS,oBAAoB,EAClC,EAAA,EACA,KAAA,EACA,OAAA,EACF,EAIG;IACD,OAAO;QACL,IAAI,MAAA,OAAA,KAAM,KAAA;QACV,SAAS,SAAA,OAAA,QAAS,KAAA;QAClB,WAAW,WAAW,OAAO,IAAI,KAAK,UAAU,GAAI,IAAI,KAAA;IAC1D;AACF;;ACPO,SAAS,aAAa,EAC3B,IAAA,EACA,2BAA2B,KAAA,EAC3B,iBAAA,EACF,EA+BE;IA1CF,IAAA;IA4CE,MAAM,QAAA,CAAA,CAAQ,KAAA,KAAK,KAAA,KAAL,OAAA,KAAA,IAAA,GAAY,MAAA,IAAS,KAAK,KAAA,GAAQ,KAAA;IAEhD,MAAM,eAA6C,CAAC,CAAA;IAEpD,IAAI,SAAS,MAAM;QACjB,OAAO;YAAE,OAAO,KAAA;YAAW,aAAa,KAAA;YAAW;QAAa;IAClE;IAEA,MAAM,aAAa,KAAK,UAAA;IAExB,IAAI,0BAA0B;QAC5B,MAAM,kBAID,CAAC,CAAA;QAEN,KAAA,MAAW,QAAQ,MAAO;YACxB,IAAI,KAAK,IAAA,KAAS,oBAAoB;gBACpC,aAAa,IAAA,CAAK;oBAAE,MAAM;oBAAoB;gBAAK,CAAC;YACtD,OAAO;gBACL,gBAAgB,IAAA,CAAK;oBACnB,MAAM,KAAK,IAAA;oBACX,aAAa,KAAK,WAAA;oBAClB,YAAY,KAAK,UAAA;gBACnB,CAAC;YACH;QACF;QAEA,IAAI,cAAc,MAAM;YACtB,OAAO;gBACL,WAAW;gBACX,eAAe,KAAA;gBACf;YACF;QACF;QAEA,MAAME,QAAO,WAAW,IAAA;QAExB,OAAQA,OAAM;YACZ,KAAK;YACL,KAAK;YACL,KAAK,KAAA;gBACH,OAAO;oBACL,WAAW;oBACX,eAAe,KAAA;oBACf;gBACF;YACF,KAAK;gBACH,MAAM,kOAAID,gCAAAA,CAA8B;oBACtC,eAAe;gBACjB,CAAC;YACH;gBACE,OAAO;oBACL,WAAW;oBACX,eAAe;wBAAE,MAAM,WAAW,QAAA;oBAAS;oBAC3C;gBACF;QACJ;IACF;IAEA,MAAM,cAQD,CAAC,CAAA;IAEN,KAAA,MAAW,QAAQ,MAAO;QACxB,IAAI,KAAK,IAAA,KAAS,oBAAoB;YACpC,aAAa,IAAA,CAAK;gBAAE,MAAM;gBAAoB;YAAK,CAAC;QACtD,OAAO;YACL,YAAY,IAAA,CAAK;gBACf,MAAM;gBACN,UAAU;oBACR,MAAM,KAAK,IAAA;oBACX,aAAa,KAAK,WAAA;oBAClB,YAAY,KAAK,UAAA;oBACjB,QAAQ,oBAAoB,OAAO,KAAA;gBACrC;YACF,CAAC;QACH;IACF;IAEA,IAAI,cAAc,MAAM;QACtB,OAAO;YAAE,OAAO;YAAa,aAAa,KAAA;YAAW;QAAa;IACpE;IAEA,MAAM,OAAO,WAAW,IAAA;IAExB,OAAQ,MAAM;QACZ,KAAK;QACL,KAAK;QACL,KAAK;YACH,OAAO;gBAAE,OAAO;gBAAa,aAAa;gBAAM;YAAa;QAC/D,KAAK;YACH,OAAO;gBACL,OAAO;gBACP,aAAa;oBACX,MAAM;oBACN,UAAU;wBACR,MAAM,WAAW,QAAA;oBACnB;gBACF;gBACA;YACF;QACF;YAAS;gBACP,MAAM,mBAA0B;gBAChC,MAAM,kOAAIA,gCAAAA,CAA8B;oBACtC,eAAe,CAAA,8BAAA,EAAiC,gBAAgB,EAAA;gBAClE,CAAC;YACH;IACF;AACF;;ANxHO,IAAM,0BAAN,MAAyD;IAQ9D,YACE,OAAA,EACA,QAAA,EACA,MAAA,CACA;QAXF,IAAA,CAAS,oBAAA,GAAuB;QAY9B,IAAA,CAAK,OAAA,GAAU;QACf,IAAA,CAAK,QAAA,GAAW;QAChB,IAAA,CAAK,MAAA,GAAS;IAChB;IAEA,IAAI,4BAAqC;QA1D3C,IAAA;QA2DI,OAAA,CAAO,KAAA,IAAA,CAAK,QAAA,CAAS,iBAAA,KAAd,OAAA,KAAmC;IAC5C;IAEA,IAAI,8BAA8B;QAEhC,IAAI,aAAa,IAAA,CAAK,OAAO,GAAG;YAC9B,OAAO;QACT;QAEA,OAAO,IAAA,CAAK,yBAAA,GAA4B,SAAS;IACnD;IAEA,IAAI,WAAmB;QACrB,OAAO,IAAA,CAAK,MAAA,CAAO,QAAA;IACrB;IAEA,IAAI,oBAA6B;QAE/B,OAAO,CAAC,IAAA,CAAK,QAAA,CAAS,cAAA;IACxB;IAEQ,QAAQ,EACd,IAAA,EACA,MAAA,EACA,SAAA,EACA,WAAA,EACA,IAAA,EACA,IAAA,EACA,gBAAA,EACA,eAAA,EACA,aAAA,EACA,cAAA,EACA,IAAA,EACA,gBAAA,EACF,EAAiD;QA7FnD,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA;QA8FI,MAAM,OAAO,KAAK,IAAA;QAElB,MAAM,WAAyC,CAAC,CAAA;QAEhD,IAAI,QAAQ,MAAM;YAChB,SAAS,IAAA,CAAK;gBACZ,MAAM;gBACN,SAAS;YACX,CAAC;QACH;QAEA,IAAA,CACE,kBAAA,OAAA,KAAA,IAAA,eAAgB,IAAA,MAAS,UACzB,eAAe,MAAA,IAAU,QACzB,CAAC,IAAA,CAAK,yBAAA,EACN;YACA,SAAS,IAAA,CAAK;gBACZ,MAAM;gBACN,SAAS;gBACT,SACE;YACJ,CAAC;QACH;QAEA,MAAM,2BAA2B,IAAA,CAAK,QAAA,CAAS,wBAAA;QAE/C,IAAI,4BAA4B,IAAA,CAAK,QAAA,CAAS,iBAAA,KAAsB,MAAM;YACxE,MAAM,kOAAIE,gCAAAA,CAA8B;gBACtC,eAAe;YACjB,CAAC;QACH;QAEA,IAAI,4BAA4B,IAAA,CAAK,yBAAA,EAA2B;YAC9D,MAAM,IAAIA,8PAAAA,CAA8B;gBACtC,eAAe;YACjB,CAAC;QACH;QAEA,MAAM,WAAW;YAAA,YAAA;YAEf,OAAO,IAAA,CAAK,OAAA;YAAA,2BAAA;YAGZ,YAAY,IAAA,CAAK,QAAA,CAAS,SAAA;YAC1B,UACE,IAAA,CAAK,QAAA,CAAS,QAAA,KAAa,QAC3B,OAAO,IAAA,CAAK,QAAA,CAAS,QAAA,KAAa,WAC9B,OACA,KAAA;YACN,cACE,OAAO,IAAA,CAAK,QAAA,CAAS,QAAA,KAAa,WAC9B,IAAA,CAAK,QAAA,CAAS,QAAA,GACd,OAAO,IAAA,CAAK,QAAA,CAAS,QAAA,KAAa,YAClC,IAAA,CAAK,QAAA,CAAS,QAAA,GACZ,IACA,KAAA,IACF,KAAA;YACN,MAAM,IAAA,CAAK,QAAA,CAAS,IAAA;YACpB,qBAAqB,IAAA,CAAK,QAAA,CAAS,iBAAA;YAAA,yBAAA;YAGnC,YAAY;YACZ;YACA,OAAO;YACP,mBAAmB;YACnB,kBAAkB;YAClB,iBAAA,CACE,kBAAA,OAAA,KAAA,IAAA,eAAgB,IAAA,MAAS,SACrB,IAAA,CAAK,yBAAA,IAA6B,eAAe,MAAA,IAAU,OACzD;gBACE,MAAM;gBACN,aAAa;oBACX,QAAQ,eAAe,MAAA;oBACvB,QAAQ;oBACR,MAAA,CAAM,KAAA,eAAe,IAAA,KAAf,OAAA,KAAuB;oBAC7B,aAAa,eAAe,WAAA;gBAC9B;YACF,IACA;gBAAE,MAAM;YAAc,IACxB,KAAA;YACN,MAAM;YACN;YAAA,4BAAA;YAGA,uBAAA,CACE,KAAA,CAAA,KAAA,oBAAA,OAAA,KAAA,IAAA,iBAAkB,MAAA,KAAlB,OAAA,KAAA,IAAA,GAA0B,mBAAA,KAA1B,OAAA,KAAiD,KAAA;YACnD,OAAA,CAAO,KAAA,CAAA,KAAA,oBAAA,OAAA,KAAA,IAAA,iBAAkB,MAAA,KAAlB,OAAA,KAAA,IAAA,GAA0B,KAAA,KAA1B,OAAA,KAAmC,KAAA;YAC1C,UAAA,CAAU,KAAA,CAAA,KAAA,oBAAA,OAAA,KAAA,IAAA,iBAAkB,MAAA,KAAlB,OAAA,KAAA,IAAA,GAA0B,QAAA,KAA1B,OAAA,KAAsC,KAAA;YAChD,YAAA,CAAY,KAAA,CAAA,KAAA,oBAAA,OAAA,KAAA,IAAA,iBAAkB,MAAA,KAAlB,OAAA,KAAA,IAAA,GAA0B,UAAA,KAA1B,OAAA,KAAwC,KAAA;YAAA,YAAA;YAGpD,UAAU,4BAA4B;gBACpC;gBACA;YACF,CAAC;QACH;QAGA,IAAI,iBAAiB,IAAA,CAAK,OAAO,GAAG;YAClC,SAAS,WAAA,GAAc,KAAA;YACvB,SAAS,KAAA,GAAQ,KAAA;YACjB,SAAS,iBAAA,GAAoB,KAAA;YAC7B,SAAS,gBAAA,GAAmB,KAAA;QAC9B;QAEA,OAAQ,MAAM;YACZ,KAAK;gBAAW;oBACd,MAAM,EAAE,KAAA,EAAO,WAAA,EAAa,SAAA,EAAW,aAAA,EAAe,YAAA,CAAa,CAAA,GACjE,aAAa;wBACX;wBACA;wBACA,mBAAmB,IAAA,CAAK,yBAAA;oBAC1B,CAAC;oBAEH,OAAO;wBACL,MAAM;4BACJ,GAAG,QAAA;4BACH;4BACA;4BACA;4BACA;wBACF;wBACA,UAAU,CAAC;+BAAG,UAAU;+BAAG,YAAY;yBAAA;oBACzC;gBACF;YAEA,KAAK;gBAAe;oBAClB,OAAO;wBACL,MAAM;4BACJ,GAAG,QAAA;4BACH,iBACE,IAAA,CAAK,yBAAA,IAA6B,KAAK,MAAA,IAAU,OAC7C;gCACE,MAAM;gCACN,aAAa;oCACX,QAAQ,KAAK,MAAA;oCACb,QAAQ;oCACR,MAAA,CAAM,KAAA,KAAK,IAAA,KAAL,OAAA,KAAa;oCACnB,aAAa,KAAK,WAAA;gCACpB;4BACF,IACA;gCAAE,MAAM;4BAAc;wBAC9B;wBACA;oBACF;gBACF;YAEA,KAAK;gBAAe;oBAClB,OAAO;wBACL,MAAM,2BACF;4BACE,GAAG,QAAA;4BACH,eAAe;gCACb,MAAM,KAAK,IAAA,CAAK,IAAA;4BAClB;4BACA,WAAW;gCACT;oCACE,MAAM,KAAK,IAAA,CAAK,IAAA;oCAChB,aAAa,KAAK,IAAA,CAAK,WAAA;oCACvB,YAAY,KAAK,IAAA,CAAK,UAAA;gCACxB;6BACF;wBACF,IACA;4BACE,GAAG,QAAA;4BACH,aAAa;gCACX,MAAM;gCACN,UAAU;oCAAE,MAAM,KAAK,IAAA,CAAK,IAAA;gCAAK;4BACnC;4BACA,OAAO;gCACL;oCACE,MAAM;oCACN,UAAU;wCACR,MAAM,KAAK,IAAA,CAAK,IAAA;wCAChB,aAAa,KAAK,IAAA,CAAK,WAAA;wCACvB,YAAY,KAAK,IAAA,CAAK,UAAA;wCACtB,QAAQ,IAAA,CAAK,yBAAA,GAA4B,OAAO,KAAA;oCAClD;gCACF;6BACF;wBACF;wBACJ;oBACF;gBACF;YAEA;gBAAS;oBACP,MAAM,mBAA0B;oBAChC,MAAM,IAAI,MAAM,CAAA,kBAAA,EAAqB,gBAAgB,EAAE;gBACzD;QACF;IACF;IAEA,MAAM,WACJ,OAAA,EAC6D;QAhSjE,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA;QAiSI,MAAM,EAAE,MAAM,IAAA,EAAM,QAAA,CAAS,CAAA,GAAI,IAAA,CAAK,OAAA,CAAQ,OAAO;QAErD,MAAM,EAAE,eAAA,EAAiB,OAAO,QAAA,CAAS,CAAA,GAAI,UAAM,oRAAA,EAAc;YAC/D,KAAK,IAAA,CAAK,MAAA,CAAO,GAAA,CAAI;gBACnB,MAAM;gBACN,SAAS,IAAA,CAAK,OAAA;YAChB,CAAC;YACD,iRAAS,iBAAA,EAAe,IAAA,CAAK,MAAA,CAAO,OAAA,CAAQ,GAAG,QAAQ,OAAO;YAC9D;YACA,uBAAuB;YACvB,4BAA2B,mSAAA,EACzB;YAEF,aAAa,QAAQ,WAAA;YACrB,OAAO,IAAA,CAAK,MAAA,CAAO,KAAA;QACrB,CAAC;QAED,MAAM,EAAE,UAAU,SAAA,EAAW,GAAG,YAAY,CAAA,GAAI;QAChD,MAAM,SAAS,SAAS,OAAA,CAAQ,CAAC,CAAA;QAEjC,IAAI;QACJ,IAAA,CAAA,CACE,KAAA,CAAA,KAAA,SAAS,KAAA,KAAT,OAAA,KAAA,IAAA,GAAgB,yBAAA,KAAhB,OAAA,KAAA,IAAA,GAA2C,gBAAA,KAAoB,QAAA,CAAA,CAC/D,KAAA,CAAA,KAAA,SAAS,KAAA,KAAT,OAAA,KAAA,IAAA,GAAgB,qBAAA,KAAhB,OAAA,KAAA,IAAA,GAAuC,aAAA,KAAiB,MACxD;YACA,mBAAmB;gBAAE,QAAQ,CAAC;YAAE;YAChC,IAAA,CAAA,CAAI,KAAA,CAAA,KAAA,SAAS,KAAA,KAAT,OAAA,KAAA,IAAA,GAAgB,yBAAA,KAAhB,OAAA,KAAA,IAAA,GAA2C,gBAAA,KAAoB,MAAM;gBACvE,iBAAiB,MAAA,CAAO,eAAA,GAAA,CACtB,KAAA,CAAA,KAAA,SAAS,KAAA,KAAT,OAAA,KAAA,IAAA,GAAgB,yBAAA,KAAhB,OAAA,KAAA,IAAA,GAA2C,gBAAA;YAC/C;YACA,IAAA,CAAA,CAAI,KAAA,CAAA,KAAA,SAAS,KAAA,KAAT,OAAA,KAAA,IAAA,GAAgB,qBAAA,KAAhB,OAAA,KAAA,IAAA,GAAuC,aAAA,KAAiB,MAAM;gBAChE,iBAAiB,MAAA,CAAO,kBAAA,GAAA,CACtB,KAAA,CAAA,KAAA,SAAS,KAAA,KAAT,OAAA,KAAA,IAAA,GAAgB,qBAAA,KAAhB,OAAA,KAAA,IAAA,GAAuC,aAAA;YAC3C;QACF;QAEA,OAAO;YACL,MAAA,CAAM,KAAA,OAAO,OAAA,CAAQ,OAAA,KAAf,OAAA,KAA0B,KAAA;YAChC,WACE,IAAA,CAAK,QAAA,CAAS,wBAAA,IAA4B,OAAO,OAAA,CAAQ,aAAA,GACrD;gBACE;oBACE,cAAc;oBACd,oRAAY,aAAA,CAAW;oBACvB,UAAU,OAAO,OAAA,CAAQ,aAAA,CAAc,IAAA;oBACvC,MAAM,OAAO,OAAA,CAAQ,aAAA,CAAc,SAAA;gBACrC;aACF,GAAA,CACA,KAAA,OAAO,OAAA,CAAQ,UAAA,KAAf,OAAA,KAAA,IAAA,GAA2B,GAAA,CAAI,CAAA,aAAS;gBAjVpD,IAAAC;gBAiVwD,OAAA;oBAC1C,cAAc;oBACd,YAAA,CAAYA,MAAA,SAAS,EAAA,KAAT,OAAAA,8QAAe,aAAA,CAAW;oBACtC,UAAU,SAAS,QAAA,CAAS,IAAA;oBAC5B,MAAM,SAAS,QAAA,CAAS,SAAA;gBAC1B;YAAA;YACN,cAAc,sBAAsB,OAAO,aAAa;YACxD,OAAO;gBACL,cAAA,CAAc,KAAA,CAAA,KAAA,SAAS,KAAA,KAAT,OAAA,KAAA,IAAA,GAAgB,aAAA,KAAhB,OAAA,KAAiC;gBAC/C,kBAAA,CAAkB,KAAA,CAAA,KAAA,SAAS,KAAA,KAAT,OAAA,KAAA,IAAA,GAAgB,iBAAA,KAAhB,OAAA,KAAqC;YACzD;YACA,SAAS;gBAAE;gBAAW;YAAY;YAClC,aAAa;gBAAE,SAAS;YAAgB;YACxC,SAAS;gBAAE,MAAM,KAAK,SAAA,CAAU,IAAI;YAAE;YACtC,UAAU,oBAAoB,QAAQ;YACtC;YACA,UAAU,4BAA4B,OAAO,QAAQ;YACrD;QACF;IACF;IAEA,MAAM,SACJ,OAAA,EAC2D;QAC3D,MAAM,EAAE,IAAA,EAAM,QAAA,CAAS,CAAA,GAAI,IAAA,CAAK,OAAA,CAAQ,OAAO;QAE/C,MAAM,OAAO;YACX,GAAG,IAAA;YACH,QAAQ;YAAA,iEAAA;YAGR,gBACE,IAAA,CAAK,MAAA,CAAO,aAAA,KAAkB,WAC1B;gBAAE,eAAe;YAAK,IACtB,KAAA;QACR;QAEA,MAAM,EAAE,eAAA,EAAiB,OAAO,QAAA,CAAS,CAAA,GAAI,8QAAM,gBAAA,EAAc;YAC/D,KAAK,IAAA,CAAK,MAAA,CAAO,GAAA,CAAI;gBACnB,MAAM;gBACN,SAAS,IAAA,CAAK,OAAA;YAChB,CAAC;YACD,iRAAS,iBAAA,EAAe,IAAA,CAAK,MAAA,CAAO,OAAA,CAAQ,GAAG,QAAQ,OAAO;YAC9D;YACA,uBAAuB;YACvB,+BAA2B,uSAAA,EACzB;YAEF,aAAa,QAAQ,WAAA;YACrB,OAAO,IAAA,CAAK,MAAA,CAAO,KAAA;QACrB,CAAC;QAED,MAAM,EAAE,UAAU,SAAA,EAAW,GAAG,YAAY,CAAA,GAAI;QAEhD,MAAM,YAQD,CAAC,CAAA;QAEN,IAAI,eAA4C;QAChD,IAAI,QAGA;YACF,cAAc,KAAA;YACd,kBAAkB,KAAA;QACpB;QACA,IAAI;QACJ,IAAI,eAAe;QAEnB,MAAM,EAAE,wBAAA,CAAyB,CAAA,GAAI,IAAA,CAAK,QAAA;QAE1C,IAAI;QACJ,OAAO;YACL,QAAQ,SAAS,WAAA,CACf,IAAI,gBAGF;gBACA,WAAU,KAAA,EAAO,UAAA,EAAY;oBAravC,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA,IAAA;oBAuaY,IAAI,CAAC,MAAM,OAAA,EAAS;wBAClB,eAAe;wBACf,WAAW,OAAA,CAAQ;4BAAE,MAAM;4BAAS,OAAO,MAAM,KAAA;wBAAM,CAAC;wBACxD;oBACF;oBAEA,MAAM,QAAQ,MAAM,KAAA;oBAGpB,IAAI,WAAW,OAAO;wBACpB,eAAe;wBACf,WAAW,OAAA,CAAQ;4BAAE,MAAM;4BAAS,OAAO,MAAM,KAAA;wBAAM,CAAC;wBACxD;oBACF;oBAEA,IAAI,cAAc;wBAChB,eAAe;wBAEf,WAAW,OAAA,CAAQ;4BACjB,MAAM;4BACN,GAAG,oBAAoB,KAAK,CAAA;wBAC9B,CAAC;oBACH;oBAEA,IAAI,MAAM,KAAA,IAAS,MAAM;wBACvB,QAAQ;4BACN,cAAA,CAAc,KAAA,MAAM,KAAA,CAAM,aAAA,KAAZ,OAAA,KAA6B,KAAA;4BAC3C,kBAAA,CAAkB,KAAA,MAAM,KAAA,CAAM,iBAAA,KAAZ,OAAA,KAAiC,KAAA;wBACrD;wBAEA,MAAM,EACJ,2BAA2B,sBAAA,EAC3B,uBAAuB,kBAAA,EACzB,GAAI,MAAM,KAAA;wBAEV,IAAA,CACE,0BAAA,OAAA,KAAA,IAAA,uBAAwB,gBAAA,KAAoB,QAAA,CAC5C,sBAAA,OAAA,KAAA,IAAA,mBAAoB,aAAA,KAAiB,MACrC;4BACA,mBAAmB;gCAAE,QAAQ,CAAC;4BAAE;4BAChC,IAAA,CAAI,0BAAA,OAAA,KAAA,IAAA,uBAAwB,gBAAA,KAAoB,MAAM;gCACpD,iBAAiB,MAAA,CAAO,eAAA,GACtB,0BAAA,OAAA,KAAA,IAAA,uBAAwB,gBAAA;4BAC5B;4BACA,IAAA,CAAI,sBAAA,OAAA,KAAA,IAAA,mBAAoB,aAAA,KAAiB,MAAM;gCAC7C,iBAAiB,MAAA,CAAO,kBAAA,GACtB,sBAAA,OAAA,KAAA,IAAA,mBAAoB,aAAA;4BACxB;wBACF;oBACF;oBAEA,MAAM,SAAS,MAAM,OAAA,CAAQ,CAAC,CAAA;oBAE9B,IAAA,CAAI,UAAA,OAAA,KAAA,IAAA,OAAQ,aAAA,KAAiB,MAAM;wBACjC,eAAe,sBAAsB,OAAO,aAAa;oBAC3D;oBAEA,IAAA,CAAI,UAAA,OAAA,KAAA,IAAA,OAAQ,KAAA,KAAS,MAAM;wBACzB;oBACF;oBAEA,MAAM,QAAQ,OAAO,KAAA;oBAErB,IAAI,MAAM,OAAA,IAAW,MAAM;wBACzB,WAAW,OAAA,CAAQ;4BACjB,MAAM;4BACN,WAAW,MAAM,OAAA;wBACnB,CAAC;oBACH;oBAEA,MAAM,iBAAiB,4BACrB,UAAA,OAAA,KAAA,IAAA,OAAQ,QAAA;oBAEV,IAAI,kBAAA,OAAA,KAAA,IAAA,eAAgB,MAAA,EAAQ;wBAC1B,IAAI,aAAa,KAAA,EAAW,CAAA,WAAW,CAAC,CAAA;wBACxC,SAAS,IAAA,CAAK,GAAG,cAAc;oBACjC;oBAEA,MAAM,kBACJ,4BAA4B,MAAM,aAAA,IAAiB,OAC/C;wBACE;4BACE,MAAM;4BACN,4QAAI,aAAA,CAAW;4BACf,UAAU,MAAM,aAAA;4BAChB,OAAO;wBACT;qBACF,GACA,MAAM,UAAA;oBAEZ,IAAI,mBAAmB,MAAM;wBAC3B,KAAA,MAAW,iBAAiB,gBAAiB;4BAC3C,MAAM,QAAQ,cAAc,KAAA;4BAG5B,IAAI,SAAA,CAAU,KAAK,CAAA,IAAK,MAAM;gCAC5B,IAAI,cAAc,IAAA,KAAS,YAAY;oCACrC,MAAM,kOAAI,2BAAA,CAAyB;wCACjC,MAAM;wCACN,SAAS,CAAA,yBAAA,CAAA;oCACX,CAAC;gCACH;gCAEA,IAAI,cAAc,EAAA,IAAM,MAAM;oCAC5B,MAAM,kOAAI,2BAAA,CAAyB;wCACjC,MAAM;wCACN,SAAS,CAAA,6BAAA,CAAA;oCACX,CAAC;gCACH;gCAEA,IAAA,CAAA,CAAI,KAAA,cAAc,QAAA,KAAd,OAAA,KAAA,IAAA,GAAwB,IAAA,KAAQ,MAAM;oCACxC,MAAM,IAAI,yPAAA,CAAyB;wCACjC,MAAM;wCACN,SAAS,CAAA,wCAAA,CAAA;oCACX,CAAC;gCACH;gCAEA,SAAA,CAAU,KAAK,CAAA,GAAI;oCACjB,IAAI,cAAc,EAAA;oCAClB,MAAM;oCACN,UAAU;wCACR,MAAM,cAAc,QAAA,CAAS,IAAA;wCAC7B,WAAA,CAAW,KAAA,cAAc,QAAA,CAAS,SAAA,KAAvB,OAAA,KAAoC;oCACjD;oCACA,aAAa;gCACf;gCAEA,MAAMC,YAAW,SAAA,CAAU,KAAK,CAAA;gCAEhC,IAAA,CAAA,CACE,KAAAA,UAAS,QAAA,KAAT,OAAA,KAAA,IAAA,GAAmB,IAAA,KAAQ,QAAA,CAAA,CAC3B,KAAAA,UAAS,QAAA,KAAT,OAAA,KAAA,IAAA,GAAmB,SAAA,KAAa,MAChC;oCAEA,IAAIA,UAAS,QAAA,CAAS,SAAA,CAAU,MAAA,GAAS,GAAG;wCAC1C,WAAW,OAAA,CAAQ;4CACjB,MAAM;4CACN,cAAc;4CACd,YAAYA,UAAS,EAAA;4CACrB,UAAUA,UAAS,QAAA,CAAS,IAAA;4CAC5B,eAAeA,UAAS,QAAA,CAAS,SAAA;wCACnC,CAAC;oCACH;oCAIA,4QAAI,iBAAA,EAAeA,UAAS,QAAA,CAAS,SAAS,GAAG;wCAC/C,WAAW,OAAA,CAAQ;4CACjB,MAAM;4CACN,cAAc;4CACd,YAAA,CAAY,KAAAA,UAAS,EAAA,KAAT,OAAA,6QAAe,aAAA,CAAW;4CACtC,UAAUA,UAAS,QAAA,CAAS,IAAA;4CAC5B,MAAMA,UAAS,QAAA,CAAS,SAAA;wCAC1B,CAAC;wCACDA,UAAS,WAAA,GAAc;oCACzB;gCACF;gCAEA;4BACF;4BAGA,MAAM,WAAW,SAAA,CAAU,KAAK,CAAA;4BAEhC,IAAI,SAAS,WAAA,EAAa;gCACxB;4BACF;4BAEA,IAAA,CAAA,CAAI,KAAA,cAAc,QAAA,KAAd,OAAA,KAAA,IAAA,GAAwB,SAAA,KAAa,MAAM;gCAC7C,SAAS,QAAA,CAAU,SAAA,IAAA,CACjB,KAAA,CAAA,KAAA,cAAc,QAAA,KAAd,OAAA,KAAA,IAAA,GAAwB,SAAA,KAAxB,OAAA,KAAqC;4BACzC;4BAGA,WAAW,OAAA,CAAQ;gCACjB,MAAM;gCACN,cAAc;gCACd,YAAY,SAAS,EAAA;gCACrB,UAAU,SAAS,QAAA,CAAS,IAAA;gCAC5B,eAAA,CAAe,KAAA,cAAc,QAAA,CAAS,SAAA,KAAvB,OAAA,KAAoC;4BACrD,CAAC;4BAGD,IAAA,CAAA,CACE,KAAA,SAAS,QAAA,KAAT,OAAA,KAAA,IAAA,GAAmB,IAAA,KAAQ,QAAA,CAAA,CAC3B,KAAA,SAAS,QAAA,KAAT,OAAA,KAAA,IAAA,GAAmB,SAAA,KAAa,gRAChC,iBAAA,EAAe,SAAS,QAAA,CAAS,SAAS,GAC1C;gCACA,WAAW,OAAA,CAAQ;oCACjB,MAAM;oCACN,cAAc;oCACd,YAAA,CAAY,KAAA,SAAS,EAAA,KAAT,OAAA,6QAAe,aAAA,CAAW;oCACtC,UAAU,SAAS,QAAA,CAAS,IAAA;oCAC5B,MAAM,SAAS,QAAA,CAAS,SAAA;gCAC1B,CAAC;gCACD,SAAS,WAAA,GAAc;4BACzB;wBACF;oBACF;gBACF;gBAEA,OAAM,UAAA,EAAY;oBAhnB5B,IAAA,IAAA;oBAinBY,WAAW,OAAA,CAAQ;wBACjB,MAAM;wBACN;wBACA;wBACA,OAAO;4BACL,cAAA,CAAc,KAAA,MAAM,YAAA,KAAN,OAAA,KAAsB;4BACpC,kBAAA,CAAkB,KAAA,MAAM,gBAAA,KAAN,OAAA,KAA0B;wBAC9C;wBACA,GAAI,oBAAoB,OAAO;4BAAE;wBAAiB,IAAI,CAAC,CAAA;oBACzD,CAAC;gBACH;YACF,CAAC;YAEH,SAAS;gBAAE;gBAAW;YAAY;YAClC,aAAa;gBAAE,SAAS;YAAgB;YACxC,SAAS;gBAAE,MAAM,KAAK,SAAA,CAAU,IAAI;YAAE;YACtC;QACF;IACF;AACF;AAEA,IAAM,+MAAyBC,IAAAA,CAC5B,MAAA,CAAO;IACN,qMAAeA,IAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;IAClC,yMAAmBA,IAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;IACtC,6MAAuBA,IAAAA,CACpB,MAAA,CAAO;QACN,qMAAeA,IAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;IACpC,CAAC,EACA,OAAA,CAAQ;IACX,iNAA2BA,IAAAA,CACxB,MAAA,CAAO;QACN,wMAAkBA,IAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;IACvC,CAAC,EACA,OAAA,CAAQ;AACb,CAAC,EACA,OAAA,CAAQ;AAIX,IAAM,iNAA2BA,IAAAA,CAAE,MAAA,CAAO;IACxC,0LAAIA,IAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;IACvB,+LAASA,IAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;IAC5B,6LAAOA,IAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;IAC1B,+LAASA,IAAAA,CAAE,KAAA,sLACTA,KAAAA,CAAE,MAAA,CAAO;QACP,+LAASA,IAAAA,CAAE,MAAA,CAAO;YAChB,4LAAMA,IAAAA,CAAE,OAAA,CAAQ,WAAW,EAAE,OAAA,CAAQ;YACrC,+LAASA,IAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;YAC5B,qMAAeA,IAAAA,CACZ,MAAA,CAAO;gBACN,iMAAWA,IAAAA,CAAE,MAAA,CAAO;gBACpB,4LAAMA,IAAAA,CAAE,MAAA,CAAO;YACjB,CAAC,EACA,OAAA,CAAQ;YACX,kMAAYA,IAAAA,CACT,KAAA,uLACCA,IAAAA,CAAE,MAAA,CAAO;gBACP,0LAAIA,IAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;gBACvB,4LAAMA,IAAAA,CAAE,OAAA,CAAQ,UAAU;gBAC1B,gMAAUA,IAAAA,CAAE,MAAA,CAAO;oBACjB,4LAAMA,IAAAA,CAAE,MAAA,CAAO;oBACf,iMAAWA,IAAAA,CAAE,MAAA,CAAO;gBACtB,CAAC;YACH,CAAC,GAEF,OAAA,CAAQ;QACb,CAAC;QACD,6LAAOA,IAAAA,CAAE,MAAA,CAAO;QAChB,gMAAUA,IAAAA,CACP,MAAA,CAAO;YACN,+LAASA,IAAAA,CACN,KAAA,uLACCA,IAAAA,CAAE,MAAA,CAAO;gBACP,6LAAOA,IAAAA,CAAE,MAAA,CAAO;gBAChB,+LAASA,IAAAA,CAAE,MAAA,CAAO;gBAClB,oMAAcA,IAAAA,CAAE,KAAA,CACdA,0LAAAA,CAAE,MAAA,CAAO;oBACP,6LAAOA,IAAAA,CAAE,MAAA,CAAO;oBAChB,+LAASA,IAAAA,CAAE,MAAA,CAAO;gBACpB,CAAC;YAEL,CAAC,GAEF,QAAA,CAAS;QACd,CAAC,EACA,OAAA,CAAQ;QACX,eAAeA,0LAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;IACpC,CAAC;IAEH,OAAO;AACT,CAAC;AAID,IAAM,8MAAwBA,IAAAA,CAAE,KAAA,CAAM;0LACpCA,IAAAA,CAAE,MAAA,CAAO;QACP,IAAIA,0LAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;QACvB,+LAASA,IAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;QAC5B,6LAAOA,IAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;QAC1B,+LAASA,IAAAA,CAAE,KAAA,uLACTA,IAAAA,CAAE,MAAA,CAAO;YACP,6LAAOA,IAAAA,CACJ,MAAA,CAAO;gBACN,MAAMA,0LAAAA,CAAE,IAAA,CAAK;oBAAC,WAAW;iBAAC,EAAE,OAAA,CAAQ;gBACpC,+LAASA,IAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;gBAC5B,qMAAeA,IAAAA,CACZ,MAAA,CAAO;oBACN,4LAAMA,IAAAA,CAAE,MAAA,CAAO,EAAE,QAAA,CAAS;oBAC1B,iMAAWA,IAAAA,CAAE,MAAA,CAAO,EAAE,QAAA,CAAS;gBACjC,CAAC,EACA,OAAA,CAAQ;gBACX,kMAAYA,IAAAA,CACT,KAAA,uLACCA,IAAAA,CAAE,MAAA,CAAO;oBACP,6LAAOA,IAAAA,CAAE,MAAA,CAAO;oBAChB,0LAAIA,IAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;oBACvB,4LAAMA,IAAAA,CAAE,OAAA,CAAQ,UAAU,EAAE,QAAA,CAAS;oBACrC,UAAUA,0LAAAA,CAAE,MAAA,CAAO;wBACjB,4LAAMA,IAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;wBACzB,iMAAWA,IAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;oBAChC,CAAC;gBACH,CAAC,GAEF,OAAA,CAAQ;YACb,CAAC,EACA,OAAA,CAAQ;YACX,gMAAUA,IAAAA,CACP,MAAA,CAAO;gBACN,+LAASA,IAAAA,CACN,KAAA,uLACCA,IAAAA,CAAE,MAAA,CAAO;oBACP,4LAAOA,KAAAA,CAAE,MAAA,CAAO;oBAChB,+LAASA,IAAAA,CAAE,MAAA,CAAO;oBAClB,oMAAcA,IAAAA,CAAE,KAAA,uLACdA,IAAAA,CAAE,MAAA,CAAO;wBACP,6LAAOA,IAAAA,CAAE,MAAA,CAAO;wBAChB,+LAASA,IAAAA,CAAE,MAAA,CAAO;oBACpB,CAAC;gBAEL,CAAC,GAEF,QAAA,CAAS;YACd,CAAC,EACA,OAAA,CAAQ;YACX,qMAAeA,IAAAA,CAAE,MAAA,CAAO,EAAE,QAAA,CAAS,EAAE,QAAA,CAAS;YAC9C,6LAAOA,IAAAA,CAAE,MAAA,CAAO;QAClB,CAAC;QAEH,OAAO;IACT,CAAC;IACD;CACD;AAED,SAAS,iBAAiB,OAAA,EAAiB;IACzC,OAAO,QAAQ,UAAA,CAAW,KAAK;AACjC;AAEA,SAAS,aAAa,OAAA,EAAiB;IACrC,OAAO,QAAQ,UAAA,CAAW,sBAAsB;AAClD;;;;;AQ3wBO,SAAS,gCAAgC,EAC9C,MAAA,EACA,WAAA,EACA,OAAO,MAAA,EACP,YAAY,WAAA,EACd,EAQE;IAEA,IACE,gBAAgB,YAChB,OAAO,MAAA,KAAW,KAClB,MAAA,CAAO,CAAC,CAAA,CAAE,IAAA,KAAS,UACnB,MAAA,CAAO,CAAC,CAAA,CAAE,OAAA,CAAQ,MAAA,KAAW,KAC7B,MAAA,CAAO,CAAC,CAAA,CAAE,OAAA,CAAQ,CAAC,CAAA,CAAE,IAAA,KAAS,QAC9B;QACA,OAAO;YAAE,QAAQ,MAAA,CAAO,CAAC,CAAA,CAAE,OAAA,CAAQ,CAAC,CAAA,CAAE,IAAA;QAAK;IAC7C;IAGA,IAAI,OAAO;IAGX,IAAI,MAAA,CAAO,CAAC,CAAA,CAAE,IAAA,KAAS,UAAU;QAC/B,QAAQ,GAAG,MAAA,CAAO,CAAC,CAAA,CAAE,OAAO,CAAA;;AAAA,CAAA;QAC5B,SAAS,OAAO,KAAA,CAAM,CAAC;IACzB;IAEA,KAAA,MAAW,EAAE,IAAA,EAAM,OAAA,CAAQ,CAAA,IAAK,OAAQ;QACtC,OAAQ,MAAM;YACZ,KAAK;gBAAU;oBACb,MAAM,kOAAI,qBAAA,CAAmB;wBAC3B,SAAS;wBACT;oBACF,CAAC;gBACH;YAEA,KAAK;gBAAQ;oBACX,MAAM,cAAc,QACjB,GAAA,CAAI,CAAA,SAAQ;wBACX,OAAQ,KAAK,IAAA,EAAM;4BACjB,KAAK;gCAAQ;oCACX,OAAO,KAAK,IAAA;gCACd;4BACA,KAAK;gCAAS;oCACZ,MAAM,kOAAIO,gCAAAA,CAA8B;wCACtC,eAAe;oCACjB,CAAC;gCACH;wBACF;oBACF,CAAC,EACA,IAAA,CAAK,EAAE;oBAEV,QAAQ,GAAG,IAAI,CAAA;AAAA,EAAM,WAAW,CAAA;;AAAA,CAAA;oBAChC;gBACF;YAEA,KAAK;gBAAa;oBAChB,MAAM,mBAAmB,QACtB,GAAA,CAAI,CAAA,SAAQ;wBACX,OAAQ,KAAK,IAAA,EAAM;4BACjB,KAAK;gCAAQ;oCACX,OAAO,KAAK,IAAA;gCACd;4BACA,KAAK;gCAAa;oCAChB,MAAM,IAAIA,8PAAAA,CAA8B;wCACtC,eAAe;oCACjB,CAAC;gCACH;wBACF;oBACF,CAAC,EACA,IAAA,CAAK,EAAE;oBAEV,QAAQ,GAAG,SAAS,CAAA;AAAA,EAAM,gBAAgB,CAAA;;AAAA,CAAA;oBAC1C;gBACF;YAEA,KAAK;gBAAQ;oBACX,MAAM,kOAAIA,gCAAAA,CAA8B;wBACtC,eAAe;oBACjB,CAAC;gBACH;YAEA;gBAAS;oBACP,MAAM,mBAA0B;oBAChC,MAAM,IAAI,MAAM,CAAA,kBAAA,EAAqB,gBAAgB,EAAE;gBACzD;QACF;IACF;IAGA,QAAQ,GAAG,SAAS,CAAA;AAAA,CAAA;IAEpB,OAAO;QACL,QAAQ;QACR,eAAe;YAAC,CAAA;AAAA,EAAK,IAAI,CAAA,CAAA,CAAG;SAAA;IAC9B;AACF;;ACrGO,SAAS,4BACd,QAAA,EACqC;IACrC,OAAO,YAAA,OAAA,KAAA,IAAA,SAAU,MAAA,CAAO,GAAA,CAAI,CAAC,OAAO,QAAA,CAAW;YAC7C;YACA,SAAS,SAAS,cAAA,CAAe,KAAK,CAAA;YACtC,aAAa,SAAS,YAAA,GAClB,OAAO,OAAA,CAAQ,SAAS,YAAA,CAAa,KAAK,CAAC,EAAE,GAAA,CAC3C,CAAC,CAACC,QAAO,OAAO,CAAA,GAAA,CAAO;oBACrB,OAAAA;oBACA;gBACF,CAAA,KAEF,CAAC,CAAA;QACP,CAAA;AACF;;AFeO,IAAM,gCAAN,MAA+D;IASpE,YACE,OAAA,EACA,QAAA,EACA,MAAA,CACA;QAZF,IAAA,CAAS,oBAAA,GAAuB;QAChC,IAAA,CAAS,2BAAA,GAA8B,KAAA;QAYrC,IAAA,CAAK,OAAA,GAAU;QACf,IAAA,CAAK,QAAA,GAAW;QAChB,IAAA,CAAK,MAAA,GAAS;IAChB;IAEA,IAAI,WAAmB;QACrB,OAAO,IAAA,CAAK,MAAA,CAAO,QAAA;IACrB;IAEQ,QAAQ,EACd,IAAA,EACA,WAAA,EACA,MAAA,EACA,SAAA,EACA,WAAA,EACA,IAAA,EACA,IAAA,EACA,gBAAA,EACA,eAAA,EACA,eAAe,iBAAA,EACf,cAAA,EACA,IAAA,EACF,EAAiD;QA1EnD,IAAA;QA2EI,MAAM,OAAO,KAAK,IAAA;QAElB,MAAM,WAAyC,CAAC,CAAA;QAEhD,IAAI,QAAQ,MAAM;YAChB,SAAS,IAAA,CAAK;gBACZ,MAAM;gBACN,SAAS;YACX,CAAC;QACH;QAEA,IAAI,kBAAkB,QAAQ,eAAe,IAAA,KAAS,QAAQ;YAC5D,SAAS,IAAA,CAAK;gBACZ,MAAM;gBACN,SAAS;gBACT,SAAS;YACX,CAAC;QACH;QAEA,MAAM,EAAE,QAAQ,gBAAA,EAAkB,aAAA,CAAc,CAAA,GAC9C,gCAAgC;YAAE;YAAQ;QAAY,CAAC;QAEzD,MAAM,OAAO,CAAC;eAAI,iBAAA,OAAA,gBAAiB,CAAC,CAAA,EAAI;eAAI,qBAAA,OAAA,oBAAqB,CAAC,CAAE;SAAA;QAEpE,MAAM,WAAW;YAAA,YAAA;YAEf,OAAO,IAAA,CAAK,OAAA;YAAA,2BAAA;YAGZ,MAAM,IAAA,CAAK,QAAA,CAAS,IAAA;YACpB,YAAY,IAAA,CAAK,QAAA,CAAS,SAAA;YAC1B,UACE,OAAO,IAAA,CAAK,QAAA,CAAS,QAAA,KAAa,WAC9B,IAAA,CAAK,QAAA,CAAS,QAAA,GACd,OAAO,IAAA,CAAK,QAAA,CAAS,QAAA,KAAa,YAClC,IAAA,CAAK,QAAA,CAAS,QAAA,GACZ,IACA,KAAA,IACF,KAAA;YACN,QAAQ,IAAA,CAAK,QAAA,CAAS,MAAA;YACtB,MAAM,IAAA,CAAK,QAAA,CAAS,IAAA;YAAA,yBAAA;YAGpB,YAAY;YACZ;YACA,OAAO;YACP,mBAAmB;YACnB,kBAAkB;YAClB;YAAA,UAAA;YAGA,QAAQ;YAAA,kBAAA;YAGR,MAAM,KAAK,MAAA,GAAS,IAAI,OAAO,KAAA;QACjC;QAEA,OAAQ,MAAM;YACZ,KAAK;gBAAW;oBACd,IAAA,CAAI,KAAA,KAAK,KAAA,KAAL,OAAA,KAAA,IAAA,GAAY,MAAA,EAAQ;wBACtB,MAAM,kOAAIC,gCAAAA,CAA8B;4BACtC,eAAe;wBACjB,CAAC;oBACH;oBAEA,IAAI,KAAK,UAAA,EAAY;wBACnB,MAAM,kOAAIA,gCAAAA,CAA8B;4BACtC,eAAe;wBACjB,CAAC;oBACH;oBAEA,OAAO;wBAAE,MAAM;wBAAU;oBAAS;gBACpC;YAEA,KAAK;gBAAe;oBAClB,MAAM,kOAAIA,gCAAAA,CAA8B;wBACtC,eAAe;oBACjB,CAAC;gBACH;YAEA,KAAK;gBAAe;oBAClB,MAAM,kOAAIA,gCAAAA,CAA8B;wBACtC,eAAe;oBACjB,CAAC;gBACH;YAEA;gBAAS;oBACP,MAAM,mBAA0B;oBAChC,MAAM,IAAI,MAAM,CAAA,kBAAA,EAAqB,gBAAgB,EAAE;gBACzD;QACF;IACF;IAEA,MAAM,WACJ,OAAA,EAC6D;QAC7D,MAAM,EAAE,IAAA,EAAM,QAAA,CAAS,CAAA,GAAI,IAAA,CAAK,OAAA,CAAQ,OAAO;QAE/C,MAAM,EAAE,eAAA,EAAiB,OAAO,QAAA,CAAS,CAAA,GAAI,OAAMC,uRAAAA,EAAc;YAC/D,KAAK,IAAA,CAAK,MAAA,CAAO,GAAA,CAAI;gBACnB,MAAM;gBACN,SAAS,IAAA,CAAK,OAAA;YAChB,CAAC;YACD,UAASC,wRAAAA,EAAe,IAAA,CAAK,MAAA,CAAO,OAAA,CAAQ,GAAG,QAAQ,OAAO;YAC9D,MAAM;YACN,uBAAuB;YACvB,mSAA2BC,4BAAAA,EACzB;YAEF,aAAa,QAAQ,WAAA;YACrB,OAAO,IAAA,CAAK,MAAA,CAAO,KAAA;QACrB,CAAC;QAED,MAAM,EAAE,QAAQ,SAAA,EAAW,GAAG,YAAY,CAAA,GAAI;QAC9C,MAAM,SAAS,SAAS,OAAA,CAAQ,CAAC,CAAA;QAEjC,OAAO;YACL,MAAM,OAAO,IAAA;YACb,OAAO;gBACL,cAAc,SAAS,KAAA,CAAM,aAAA;gBAC7B,kBAAkB,SAAS,KAAA,CAAM,iBAAA;YACnC;YACA,cAAc,sBAAsB,OAAO,aAAa;YACxD,UAAU,4BAA4B,OAAO,QAAQ;YACrD,SAAS;gBAAE;gBAAW;YAAY;YAClC,aAAa;gBAAE,SAAS;YAAgB;YACxC,UAAU,oBAAoB,QAAQ;YACtC;YACA,SAAS;gBAAE,MAAM,KAAK,SAAA,CAAU,IAAI;YAAE;QACxC;IACF;IAEA,MAAM,SACJ,OAAA,EAC2D;QAC3D,MAAM,EAAE,IAAA,EAAM,QAAA,CAAS,CAAA,GAAI,IAAA,CAAK,OAAA,CAAQ,OAAO;QAE/C,MAAM,OAAO;YACX,GAAG,IAAA;YACH,QAAQ;YAAA,iEAAA;YAGR,gBACE,IAAA,CAAK,MAAA,CAAO,aAAA,KAAkB,WAC1B;gBAAE,eAAe;YAAK,IACtB,KAAA;QACR;QAEA,MAAM,EAAE,eAAA,EAAiB,OAAO,QAAA,CAAS,CAAA,GAAI,MAAMF,wRAAAA,EAAc;YAC/D,KAAK,IAAA,CAAK,MAAA,CAAO,GAAA,CAAI;gBACnB,MAAM;gBACN,SAAS,IAAA,CAAK,OAAA;YAChB,CAAC;YACD,iRAASC,iBAAAA,EAAe,IAAA,CAAK,MAAA,CAAO,OAAA,CAAQ,GAAG,QAAQ,OAAO;YAC9D;YACA,uBAAuB;YACvB,4BAA2BE,0SAAAA,EACzB;YAEF,aAAa,QAAQ,WAAA;YACrB,OAAO,IAAA,CAAK,MAAA,CAAO,KAAA;QACrB,CAAC;QAED,MAAM,EAAE,QAAQ,SAAA,EAAW,GAAG,YAAY,CAAA,GAAI;QAE9C,IAAI,eAA4C;QAChD,IAAI,QAA4D;YAC9D,cAAc,OAAO,GAAA;YACrB,kBAAkB,OAAO,GAAA;QAC3B;QACA,IAAI;QACJ,IAAI,eAAe;QAEnB,OAAO;YACL,QAAQ,SAAS,WAAA,CACf,IAAI,gBAGF;gBACA,WAAU,KAAA,EAAO,UAAA,EAAY;oBAE3B,IAAI,CAAC,MAAM,OAAA,EAAS;wBAClB,eAAe;wBACf,WAAW,OAAA,CAAQ;4BAAE,MAAM;4BAAS,OAAO,MAAM,KAAA;wBAAM,CAAC;wBACxD;oBACF;oBAEA,MAAM,QAAQ,MAAM,KAAA;oBAGpB,IAAI,WAAW,OAAO;wBACpB,eAAe;wBACf,WAAW,OAAA,CAAQ;4BAAE,MAAM;4BAAS,OAAO,MAAM,KAAA;wBAAM,CAAC;wBACxD;oBACF;oBAEA,IAAI,cAAc;wBAChB,eAAe;wBAEf,WAAW,OAAA,CAAQ;4BACjB,MAAM;4BACN,GAAG,oBAAoB,KAAK,CAAA;wBAC9B,CAAC;oBACH;oBAEA,IAAI,MAAM,KAAA,IAAS,MAAM;wBACvB,QAAQ;4BACN,cAAc,MAAM,KAAA,CAAM,aAAA;4BAC1B,kBAAkB,MAAM,KAAA,CAAM,iBAAA;wBAChC;oBACF;oBAEA,MAAM,SAAS,MAAM,OAAA,CAAQ,CAAC,CAAA;oBAE9B,IAAA,CAAI,UAAA,OAAA,KAAA,IAAA,OAAQ,aAAA,KAAiB,MAAM;wBACjC,eAAe,sBAAsB,OAAO,aAAa;oBAC3D;oBAEA,IAAA,CAAI,UAAA,OAAA,KAAA,IAAA,OAAQ,IAAA,KAAQ,MAAM;wBACxB,WAAW,OAAA,CAAQ;4BACjB,MAAM;4BACN,WAAW,OAAO,IAAA;wBACpB,CAAC;oBACH;oBAEA,MAAM,iBAAiB,4BACrB,UAAA,OAAA,KAAA,IAAA,OAAQ,QAAA;oBAEV,IAAI,kBAAA,OAAA,KAAA,IAAA,eAAgB,MAAA,EAAQ;wBAC1B,IAAI,aAAa,KAAA,EAAW,CAAA,WAAW,CAAC,CAAA;wBACxC,SAAS,IAAA,CAAK,GAAG,cAAc;oBACjC;gBACF;gBAEA,OAAM,UAAA,EAAY;oBAChB,WAAW,OAAA,CAAQ;wBACjB,MAAM;wBACN;wBACA;wBACA;oBACF,CAAC;gBACH;YACF,CAAC;YAEH,SAAS;gBAAE;gBAAW;YAAY;YAClC,aAAa;gBAAE,SAAS;YAAgB;YACxC;YACA,SAAS;gBAAE,MAAM,KAAK,SAAA,CAAU,IAAI;YAAE;QACxC;IACF;AACF;AAIA,IAAM,iCAAiCC,0LAAAA,CAAE,MAAA,CAAO;IAC9C,0LAAIA,IAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;IACvB,+LAASA,IAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;IAC5B,6LAAOA,IAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;IAC1B,SAASA,0LAAAA,CAAE,KAAA,uLACTA,IAAAA,CAAE,MAAA,CAAO;QACP,4LAAMA,IAAAA,CAAE,MAAA,CAAO;QACf,qMAAeA,IAAAA,CAAE,MAAA,CAAO;QACxB,+LAAUA,KAAAA,CACP,MAAA,CAAO;YACN,8LAAQA,IAAAA,CAAE,KAAA,uLAAMA,IAAAA,CAAE,MAAA,CAAO,CAAC;YAC1B,sMAAgBA,IAAAA,CAAE,KAAA,uLAAMA,IAAAA,CAAE,MAAA,CAAO,CAAC;YAClC,oMAAcA,IAAAA,CAAE,KAAA,uLAAMA,IAAAA,CAAE,MAAA,uLAAOA,IAAAA,CAAE,MAAA,CAAO,yLAAGA,IAAAA,CAAE,MAAA,CAAO,CAAC,CAAC,EAAE,QAAA,CAAS;QACnE,CAAC,EACA,OAAA,CAAQ;IACb,CAAC;IAEH,6LAAOA,IAAAA,CAAE,MAAA,CAAO;QACd,qMAAeA,IAAAA,CAAE,MAAA,CAAO;QACxB,yMAAmBA,IAAAA,CAAE,MAAA,CAAO;IAC9B,CAAC;AACH,CAAC;AAID,IAAM,oNAA8BA,IAAAA,CAAE,KAAA,CAAM;0LAC1CA,IAAAA,CAAE,MAAA,CAAO;QACP,0LAAIA,IAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;QACvB,SAASA,0LAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;QAC5B,6LAAOA,IAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;QAC1B,+LAASA,IAAAA,CAAE,KAAA,uLACTA,IAAAA,CAAE,MAAA,CAAO;YACP,4LAAMA,IAAAA,CAAE,MAAA,CAAO;YACf,qMAAeA,IAAAA,CAAE,MAAA,CAAO,EAAE,OAAA,CAAQ;YAClC,6LAAOA,IAAAA,CAAE,MAAA,CAAO;YAChB,gMAAUA,IAAAA,CACP,MAAA,CAAO;gBACN,8LAAQA,IAAAA,CAAE,KAAA,uLAAMA,IAAAA,CAAE,MAAA,CAAO,CAAC;gBAC1B,sMAAgBA,IAAAA,CAAE,KAAA,uLAAMA,IAAAA,CAAE,MAAA,CAAO,CAAC;gBAClC,oMAAcA,IAAAA,CAAE,KAAA,uLAAMA,IAAAA,CAAE,MAAA,uLAAOA,IAAAA,CAAE,MAAA,CAAO,yLAAGA,IAAAA,CAAE,MAAA,CAAO,CAAC,CAAC,EAAE,QAAA,CAAS;YACnE,CAAC,EACA,OAAA,CAAQ;QACb,CAAC;QAEH,6LAAOA,IAAAA,CACJ,MAAA,CAAO;YACN,qMAAeA,IAAAA,CAAE,MAAA,CAAO;YACxB,yMAAmBA,IAAAA,CAAE,MAAA,CAAO;QAC9B,CAAC,EACA,OAAA,CAAQ;IACb,CAAC;IACD;CACD;;;;AGrWM,IAAM,uBAAN,MAA+D;IAmBpE,YACE,OAAA,EACA,QAAA,EACA,MAAA,CACA;QAtBF,IAAA,CAAS,oBAAA,GAAuB;QAuB9B,IAAA,CAAK,OAAA,GAAU;QACf,IAAA,CAAK,QAAA,GAAW;QAChB,IAAA,CAAK,MAAA,GAAS;IAChB;IApBA,IAAI,WAAmB;QACrB,OAAO,IAAA,CAAK,MAAA,CAAO,QAAA;IACrB;IAEA,IAAI,uBAA+B;QAnCrC,IAAA;QAoCI,OAAA,CAAO,KAAA,IAAA,CAAK,QAAA,CAAS,oBAAA,KAAd,OAAA,KAAsC;IAC/C;IAEA,IAAI,wBAAiC;QAvCvC,IAAA;QAwCI,OAAA,CAAO,KAAA,IAAA,CAAK,QAAA,CAAS,qBAAA,KAAd,OAAA,KAAuC;IAChD;IAYA,MAAM,QAAQ,EACZ,MAAA,EACA,OAAA,EACA,WAAA,EACF,EAEE;QACA,IAAI,OAAO,MAAA,GAAS,IAAA,CAAK,oBAAA,EAAsB;YAC7C,MAAM,kOAAI,qCAAA,CAAmC;gBAC3C,UAAU,IAAA,CAAK,QAAA;gBACf,SAAS,IAAA,CAAK,OAAA;gBACd,sBAAsB,IAAA,CAAK,oBAAA;gBAC3B;YACF,CAAC;QACH;QAEA,MAAM,EAAE,eAAA,EAAiB,OAAO,QAAA,CAAS,CAAA,GAAI,8QAAMK,gBAAAA,EAAc;YAC/D,KAAK,IAAA,CAAK,MAAA,CAAO,GAAA,CAAI;gBACnB,MAAM;gBACN,SAAS,IAAA,CAAK,OAAA;YAChB,CAAC;YACD,iRAASC,iBAAAA,EAAe,IAAA,CAAK,MAAA,CAAO,OAAA,CAAQ,GAAG,OAAO;YACtD,MAAM;gBACJ,OAAO,IAAA,CAAK,OAAA;gBACZ,OAAO;gBACP,iBAAiB;gBACjB,YAAY,IAAA,CAAK,QAAA,CAAS,UAAA;gBAC1B,MAAM,IAAA,CAAK,QAAA,CAAS,IAAA;YACtB;YACA,uBAAuB;YACvB,mSAA2BC,4BAAAA,EACzB;YAEF;YACA,OAAO,IAAA,CAAK,MAAA,CAAO,KAAA;QACrB,CAAC;QAED,OAAO;YACL,YAAY,SAAS,IAAA,CAAK,GAAA,CAAI,CAAA,OAAQ,KAAK,SAAS;YACpD,OAAO,SAAS,KAAA,GACZ;gBAAE,QAAQ,SAAS,KAAA,CAAM,aAAA;YAAc,IACvC,KAAA;YACJ,aAAa;gBAAE,SAAS;YAAgB;QAC1C;IACF;AACF;AAIA,IAAM,0NAAoCC,IAAAA,CAAE,MAAA,CAAO;IACjD,4LAAMA,IAAAA,CAAE,KAAA,CAAMA,0LAAAA,CAAE,MAAA,CAAO;QAAE,iMAAWA,IAAAA,CAAE,KAAA,uLAAMA,IAAAA,CAAE,MAAA,CAAO,CAAC;IAAE,CAAC,CAAC;IAC1D,6LAAOA,IAAAA,CAAE,MAAA,CAAO;QAAE,qMAAeA,IAAAA,CAAE,MAAA,CAAO;IAAE,CAAC,EAAE,OAAA,CAAQ;AACzD,CAAC","ignoreList":[0,1,2,3,4,5,6,7,8,9,10]}},
    {"offset": {"line": 2799, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}